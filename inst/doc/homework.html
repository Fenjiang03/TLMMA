<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Fen Jiang" />

<meta name="date" content="2023-11-27" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Fen Jiang</h4>
<h4 class="date">2023-11-27</h4>



<div id="homework1-2023.9.11" class="section level1">
<h1>homework1 2023.9.11</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
<div id="answers" class="section level3">
<h3>Answers</h3>
<div id="example-1" class="section level4">
<h4>Example 1</h4>
<p>In this part, I reproduce part of the content of the article “<a href="https://www.tandfonline.com/doi/full/10.1080/15326349.2022.2112604">Complete
<span class="math inline">\(q\)</span>-th moment convergence for the
maximum of partial sums of <span class="math inline">\(m\)</span>-negatively associated random variables
and its application to the EV regression model</a>”.</p>
<p> </p>
<p><span class="math inline">\((i)~~E[\psi
(|X|)]&lt;\infty\)</span>;</p>
<p><span class="math inline">\((ii)~~\frac{n}{\phi(n)}E|X|I(|X|&gt;\phi(n)) \to
0\)</span> as <span class="math inline">\(n \to \infty\)</span>;</p>
<p><span class="math inline">\((iii)~~\sum\limits_{i=1}^{n}\phi
^{-s}(i)\phi ^{s}(n)=O(n)\)</span>,\ then for any <span class="math inline">\(\varepsilon &gt;0\)</span>, <span class="math display">\[\begin{eqnarray}
\sum_{n=1}^{\infty}\frac{1}{n}E\left \{ {\phi^{-1}(n)\max\limits_{1\leq
l\leq n}|S_{l}|-\varepsilon } \right \}_{+}^{q}&lt;\infty.
\end{eqnarray}\]</span></p>
<p>In this section, we will give an application of the main result to
the EV model and present the strong consistency property for the
estimator based on <span class="math inline">\({\it m}\)</span>-NA
errors.</p>
<p>Consider the following simple linear EV model: <span class="math display">\[\begin{eqnarray}
&amp;&amp;\eta _{i}=\theta +\beta x_{i}+\epsilon _{i},\quad \xi
_{i}=x_{i}+\delta _{i},\quad 1\leq i\leq n,
\end{eqnarray}\]</span> where <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\beta\)</span> are unknown parameters, <span class="math inline">\(x_{1},x_{2},\cdots,x_{n}\)</span> are unknown
constants, <span class="math inline">\((\epsilon_{1},\delta_{1}),(\epsilon
_{2},\delta_{2})\)</span>,<span class="math inline">\(\cdots,(\epsilon
_{n},\delta_{n})\)</span> are random vectors and <span class="math inline">\(\xi _{i}\)</span>, <span class="math inline">\(\eta _{i}\)</span>, <span class="math inline">\(i=1,2,\cdots,n\)</span> are observable variables.
From (2) we have <span class="math display">\[\begin{eqnarray}
&amp;&amp;\eta _{i}=\theta +\beta \xi_{i}+\upsilon _{i},\quad \upsilon
_{i}=\epsilon _{i}-\beta \delta_{i},\quad 1\leq i\leq n.
\end{eqnarray}\]</span></p>
<p>Consider formula (3) as a usual regression model of <span class="math inline">\(\eta _{i}\)</span> on <span class="math inline">\(\xi_{i}\)</span>, we get the least squares (LS,
for short) estimators of <span class="math inline">\(\beta\)</span> and
<span class="math inline">\(\theta\)</span> as follows: <span class="math display">\[\begin{eqnarray}
&amp;&amp;\hat{\beta}_{n}=\frac{\sum\limits_{i=1}^{n}(\xi
_{i}-\bar{\xi}_{n})(\eta _{i}-\bar{\eta}_{n})}{\sum\limits_{i=1}^{n}(\xi
_{i}-\bar{\xi}_{n})^{2}},\quad
\hat{\theta}_{n}=\bar{\eta}_{n}-\hat{\beta}_{n}\bar{\xi}_{n},
\end{eqnarray}\]</span> where <span class="math inline">\(\bar{\xi}
_{n}=n^{-1}\sum\limits_{i=1}^{n}\xi _{n}\)</span>, and other similar
notations, such as <span class="math inline">\(\bar{\eta}_{n}\)</span>,
<span class="math inline">\(\bar{\delta}_{n}\)</span> and <span class="math inline">\(\bar{x}_{n}\)</span> are defined in the same way.
Denote <span class="math inline">\(D_{n}=\sum\limits_{i=1}^{n}(x_{i}-\bar{x}_{n})^{2}\)</span>
for each <span class="math inline">\(n\geq1\)</span>. From (2) and (4),
we can get that <span class="math display">\[\begin{eqnarray}
&amp;&amp;\hat{\beta}_{n}-\beta=\frac{\sum\limits_{i=1}^{n}(\delta_{i}-\bar{\delta}_{n})\epsilon
_{i}+\sum\limits_{i=1}^{n}(x_{i}-\bar{x}_{n})(\epsilon _{i}-\beta \delta
_{i})-\beta\sum\limits_{i=1}^{n}(\delta  _{i}-\bar{\delta }_{n})^{2}
}{\sum\limits_{i=1}^{n}(\xi _{i}-\bar{\xi}_{n})^{2}},
\end{eqnarray}\]</span> and <span class="math display">\[\begin{eqnarray}
&amp;&amp;\hat{\theta}_{n}-\theta
=(\beta-\hat{\beta}_{n})\bar{x}_{n}+(\beta-\hat{\beta}_{n})\bar{\delta}_{n}+\bar{\epsilon
}_{n}-\beta\bar{\delta}_{n}.
\end{eqnarray}\]</span></p>
<p> </p>
<p>Then, we will perform a numerical simulation to study the strong
consistency of the LS estimator <span class="math inline">\(\hat{\beta}_{n}\)</span> and <span class="math inline">\(\hat{\theta}_{n}\)</span> in the simple linear EV
model. The data are generated from the model (2). For any <span class="math inline">\(n\geq3\)</span> and <span class="math inline">\(m\geq1\)</span>, assume <span class="math inline">\((\nu_{1},\nu_{2},\cdots,\nu_{n+m})\sim
N_{n+m}(\mathbf{0},\mathbf{\Sigma})\)</span>, <span class="math inline">\((\rho_{1},\rho_{2},\cdots,\rho_{n+m})\sim
N_{n+m}(\mathbf{0},\mathbf{\Sigma})\)</span> where <span class="math inline">\(\mathbf{0}\)</span> is a zero vector and <span class="math display">\[\begin{eqnarray*}
\mathbf{\Sigma}
=\left(
\begin{array}{ccccccc}
1+\frac{1}{n+m}\mu &amp;-\mu   &amp;0&amp;\cdots&amp; 0 &amp; 0 &amp; 0
\\
-\mu  &amp;1+\frac{2}{n+m}\mu &amp;-\mu&amp;\cdots&amp; 0 &amp; 0 &amp;
0 \\
0 &amp;-\mu  &amp;1+\frac{3}{n+m}\mu &amp;\cdots&amp; 0 &amp; 0 &amp; 0
\\
\vdots &amp;\vdots &amp; \vdots &amp; &amp; \vdots &amp; \vdots&amp;
\vdots \\
0 &amp;0 &amp;0 &amp;\cdots&amp; 1+\frac{n+m-2}{n+m}\mu &amp;
-\mu   &amp;0 \\
0 &amp;0 &amp;0 &amp;\cdots&amp; -\mu  &amp; 1+\frac{n+m-1}{n+m}\mu
&amp; -\mu \\
0 &amp;0 &amp;0 &amp;\cdots&amp; 0&amp;-\mu  &amp; 1+\mu
\end{array}
\right)
\end{eqnarray*}\]</span> with <span class="math inline">\(\mu=0.1\)</span>.</p>
<p>According to Joag-Dev and Proschan (1983), it is easy to prove that
<span class="math inline">\((\nu_{1},\nu_{2},\cdots,\nu_{n+m})\)</span>
and <span class="math inline">\((\rho_{1},\rho_{2},\cdots,\rho_{n+m})\)</span>
generated as the method above are both NA vectors for each <span class="math inline">\(n\geq3\)</span> and <span class="math inline">\(m\geq1\)</span>. For fixed positive integer <span class="math inline">\(m\)</span> and <span class="math inline">\(1\leq
i\leq n\)</span>, let <span class="math inline">\(\varepsilon_{i}=\sum\limits_{k=1}^{m}\nu_{i+k-1}\)</span>
and <span class="math inline">\(\delta_{i}=\sum\limits_{k=1}^{m}\rho_{i+k-1}\)</span>,
then it is easy to prove that <span class="math inline">\(\{\varepsilon_{i},1\leq i\leq n\}\)</span> and
<span class="math inline">\(\{\delta_{i},1\leq i\leq n\}\)</span> are
both sequences of <span class="math inline">\(m\)</span>-NA random
variables. Set <span class="math inline">\(x_{i}=i^{0.8}\)</span> for
all <span class="math inline">\(1\leq i\leq n\)</span>. It is obvious
that all the conditions of Theorem 4.1 are satisfied.</p>
<p>Next, for different values of <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\theta\)</span>, we consider the following two
cases, taking the <span class="math inline">\(\theta=0.6\)</span> and
<span class="math inline">\(\beta=1.8\)</span>, or <span class="math inline">\(\theta=2\)</span> and <span class="math inline">\(\beta=1.1\)</span>. By taking the sample sizes
<span class="math inline">\(n\)</span> as <span class="math inline">\(n\)</span>= 100, 300, 600, 900, respectively. We
apply Matlab software to compute the values of <span class="math inline">\(\hat{\beta}_{n}-\beta\)</span> and <span class="math inline">\(\hat{\theta}_{n}-\theta\)</span> for 200 times and
obtain the biases of <span class="math inline">\(\beta-\hat{\beta}_{n}\)</span> and <span class="math inline">\(\theta-\hat{\theta}_{n}\)</span> and the RMSE of
<span class="math inline">\(\hat{\beta}_{n}\)</span> and <span class="math inline">\(\hat{\theta}_{n}\)</span> in Tables 1-2 and the
plots of <span class="math inline">\(\hat{\beta}_{n}-\beta\)</span> and
<span class="math inline">\(\hat{\theta}_{n}-\theta\)</span> in Figures
1-4. In order to get a better view of how the value fluctuates, we draw
a red line where the value of 0 is in each plot.</p>
<p>From Tables 1 and 2, we can more accurately observe that not only the
values of <span class="math inline">\(\hat{\beta}_{n}-\beta\)</span> and
<span class="math inline">\(\hat{\theta}_{n}-\theta\)</span> fluctuate
around zero, but also a phenomenon that as the sample size <span class="math inline">\(n\)</span> increases, the fluctuation ranges and
the values of RMSE of <span class="math inline">\(\hat{\beta}_{n}\)</span> and <span class="math inline">\(\hat{\theta}_{n}\)</span> both decrease. These
provide verifications to our theoretical results.</p>
</div>
<div id="example-2" class="section level4">
<h4>Example 2</h4>
<p>In this example, I generated matrix datajf and matrix datajf1 from
the R code and then embellished them with the knitr function, showing
the direct output of R and then the output of the knitr function.</p>
<pre><code>##   name v1 v2  v3 v4
## 1    a  1  1 0.1  1
## 2    b  1  3 0.6  2
## 3    c  1  5 1.1  3
## 4    d  1  7 1.6  4
## 5    e  1  9 2.1  5
## 6    f  1 11 2.6  6</code></pre>
<p>It can be seen that the knitr::kable statement has a good
beautification effect for the typesetting and font of matrix variables.
Next I chose two pictures to show side by side.</p>
<p>Next, I defined two vectors <span class="math inline">\(y=(4,2.9,5.6,6,3.9,4,5,5,4,5,6)^{\top}\)</span>
and <span class="math inline">\(y=(0,1,6,7.8,2,3.5,6,7.6,4.5,7,8)^{\top}\)</span>
to do linear regression, the result obtained by using the lm function of
R language is as follows:</p>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.61560 -0.40685 -0.01659  0.41303  0.78460 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.21540    0.31940  10.067 3.38e-06 ***
## x            0.30020    0.05736   5.234 0.000539 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.519 on 9 degrees of freedom
## Multiple R-squared:  0.7527, Adjusted R-squared:  0.7252 
## F-statistic: 27.39 on 1 and 9 DF,  p-value: 0.0005392</code></pre>
<p>The drawing results are shown below:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3" class="section level4">
<h4>Example 3</h4>
<p>In this part, I reproduce part of the content of the article “<a href="https://link.springer.com/article/10.1007/s13398-017-0399-2">Equivalent
conditions of complete moment convergence and complete integral
convergence for <span class="math inline">\(m\)</span>-ANA sequence and
statistical applications</a>”.</p>
<p>In this subsection, we will perform a numerical simulation to study
the complete consistency of the estimator <span class="math inline">\(\tilde{g}_{n}(t)\)</span>. For any <span class="math inline">\(n\geq3\)</span> and <span class="math inline">\(m\geq1\)</span>, assume <span class="math inline">\((e_{1},e_{2},\cdots,e_{n+m})\sim
N_{n+m}(\mathbf{0},\mathbf{\Sigma})\)</span>, where <span class="math inline">\(\mathbf{0}\)</span> is a zero vector and <span class="math display">\[\begin{eqnarray*}
\mathbf{\Sigma}
=\left(
\begin{array}{ccccccc}
1+\frac{1}{n+m} &amp;-\theta  &amp;0&amp;\cdots&amp; 0 &amp; 0 &amp; 0
\\
-\theta &amp;1+\frac{2}{n+m} &amp;-\theta&amp;\cdots&amp; 0 &amp; 0
&amp; 0 \\
0 &amp;-\theta &amp;1+\frac{3}{n+m}&amp;\cdots&amp; 0 &amp; 0 &amp; 0 \\
\vdots &amp;\vdots &amp; \vdots &amp; &amp; \vdots &amp; \vdots&amp;
\vdots \\
0 &amp;0 &amp;0 &amp;\cdots&amp; 1+\frac{n+m-2}{n+m} &amp;
-\theta  &amp;0 \\
0 &amp;0 &amp;0 &amp;\cdots&amp; -\theta &amp; 1+\frac{n+m-1}{n+m} &amp;
-\theta \\
0 &amp;0 &amp;0 &amp;\cdots&amp; 0&amp;-\theta &amp; 1+1
\end{array}
\right)_{(n+m)\times (n+m)},
\end{eqnarray*}\]</span> where <span class="math inline">\(0&lt;\theta&lt;1\)</span>. According to Joag-Dev
and Proschan (1983), it is obvious that <span class="math inline">\((e_{1},e_{2},\cdots,e_{n+m})\)</span> is a NA
vector for each <span class="math inline">\(n\geq3\)</span> and <span class="math inline">\(m\geq1\)</span> with finite moment of any order.
For fixed positive integer <span class="math inline">\(m\)</span> and
<span class="math inline">\(i\geq1\)</span>, let <span class="math inline">\(\varepsilon_{i}=\sum\limits_{k=1}^{m}e_{i+k-1}\)</span>.
Then it is easy to prove that <span class="math inline">\(\{\varepsilon_{i},i\geq1\}\)</span> is a sequence
of <span class="math inline">\(m\)</span>-NA random variables. We choose
<span class="math inline">\(\theta=0.5\)</span>, <span class="math inline">\(m=10\)</span>, <span class="math inline">\(\beta=1.5\)</span>, <span class="math inline">\(k_{n}=\lfloor n^{0.8}\rfloor\)</span> and take
<span class="math inline">\(\eta=0.8\)</span> in Corollary 4.1. It is
easy to check that all conditions of Corollary 4.1 are satisfied. Taking
the points <span class="math inline">\(t=0.25,0.5,0.75\)</span> and the
sample sizes <span class="math inline">\(n\)</span> as <span class="math inline">\(n=200,400,800,1200\)</span>, respectively, we use
R software to compute <span class="math inline">\(\tilde{g}_{n}(t)-g(t)\)</span> with <span class="math inline">\(g(t)=2t^{3}+\ln(t^{2}+1)\)</span> and <span class="math inline">\(g(t)=3e^{-2t}+\cos t\)</span> for 1000 times and
obtain the Mean Squared Errors (MSE, for short) of <span class="math inline">\(\tilde{g}_{n}(t)\)</span> in Table 3 and the
boxplots of <span class="math inline">\(\tilde{g}_{n}(t)-g(t)\)</span>
in Figures 1-6.</p>
<p>Table 3 reflects accurately that the MSE of <span class="math inline">\(\tilde{g}_{n}(t)\)</span> decreases significantly
as <span class="math inline">\(n\)</span> increases. These simulation
results are consistent with theoretical results.</p>
</div>
<div id="example-4" class="section level4">
<h4>Example 4</h4>
<p>In this part, I reproduce part of the content of the article “<a href="https://link.springer.com/article/10.1007/s10114-019-8315-7">Complete
<span class="math inline">\(f\)</span>-moment convergence for widely
orthant dependent random variables and its application in nonparametric
models</a>”.</p>
<p>In this section, we will give an application to nonparametric
regression models based on WOD errors.</p>
<p>Consider the following nonparametric regression model: <span class="math display">\[\begin{eqnarray}
Y_{ni}=f(x_{ni})+\varepsilon_{ni},~\textrm~{i=1,2,\cdots,n,~n\geq1},
\end{eqnarray}\]</span> where <span class="math inline">\(x_{ni}\)</span> are known fixed design points from
<span class="math inline">\(A\)</span>, <span class="math inline">\(A\subset R^{d}\)</span> is a given compact set for
some positive integer <span class="math inline">\(d\geq1\)</span>. <span class="math inline">\(f(\cdot)\)</span> is an unknown regression
function defined on <span class="math inline">\(A\)</span> and <span class="math inline">\(\varepsilon_{ni}\)</span> are random errors. As an
estimator of <span class="math inline">\(f(\cdot)\)</span>, we will
consider the following weighted linear regression estimator: <span class="math display">\[\begin{eqnarray}
f_{n}(x)=\sum_{i=1}^{n}W_{ni}(x)Y_{ni}, ~\textrm~{x\in A\subset R^{d},}
\end{eqnarray}\]</span> where <span class="math inline">\(W_{ni}=W_{ni}(x; x_{n1}, x_{n2},\cdots,
x_{nn})\)</span>, <span class="math inline">\(i=1,2,\cdots, n\)</span>
are the weight functions.</p>
<p>When <span class="math inline">\(\theta=0.5\)</span>, Figures 1-3 are
the boxplots of <span class="math inline">\(\widetilde{f_{n}}(x)-f(x)\)</span> for <span class="math inline">\(f(x)=\sin x\)</span> and Figures 4-6 are the
boxplots of <span class="math inline">\(\widetilde{f_{n}}(x)-f(x)\)</span> for <span class="math inline">\(f(x)=x^{1.5}\)</span> with <span class="math inline">\(x=0.25,0.5,0.75\)</span>, respectively. We can
find that no matter <span class="math inline">\(f(x)=x^{1.5}\)</span> or
<span class="math inline">\(f(x)=\sin x\)</span>, for <span class="math inline">\(x=0.25,0.5,0.75\)</span>, the differences <span class="math inline">\(\widetilde{f_{n}}(x)-f(x)\)</span> fluctuate to
zero and the variation range decreases markedly as the sample <span class="math inline">\(n\)</span> increases. Table 4 reflects precisely
that the MSE of <span class="math inline">\(\widetilde{f_{n}}(x)\)</span> decreases markedly
as <span class="math inline">\(n\)</span> increases. These simulation
results agree with the theoretical results.</p>
<p>When <span class="math inline">\(\theta=0.1\)</span>, Figures 7-9 are
the boxplots of <span class="math inline">\(\widetilde{f_{n}}(x)-f(x)\)</span> for <span class="math inline">\(f(x)=\sin x\)</span> and Figures 10-12 are the
boxplots of <span class="math inline">\(\widetilde{f_{n}}(x)-f(x)\)</span> for <span class="math inline">\(f(x)=x^{1.5}\)</span> with <span class="math inline">\(x=0.25,0.5,0.75\)</span>, respectively. We can
obtain the same conclusions as those when <span class="math inline">\(\theta=0.5\)</span>. Table 5 also reflects
precisely that the MSE of <span class="math inline">\(\widetilde{f_{n}}(x)\)</span> decreases markedly
as <span class="math inline">\(n\)</span> increases. These simulation
results agree with the theoretical results again.</p>
</div>
</div>
</div>
</div>
<div id="homework2-2023.9.18" class="section level1">
<h1>homework2 2023.9.18</h1>
<div id="question-3.2" class="section level2">
<h2>Question 3.2</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{−|x|}\)</span>, <span class="math inline">\(x \in \mathbb{R}\)</span>. Use the inverse
transform method to generate a random sample of size 1000 from this
distribution. Use one of the methods shown in this chapter to compare
the generated sample to the target distribution.</p>
<div id="answer" class="section level3">
<h3>Answer</h3>
<p>Since the probability density function of the random variable <span class="math inline">\(X\)</span> is <span class="math inline">\(f(x)=\frac{1}{2}e^{−|x|}\)</span>, we can
calculate its distribution function <span class="math inline">\(F_X(x)\)</span> as follows <span class="math display">\[
F_X(x)=\int_{-\infty}^{x} f(x) dx=\left\{\begin{matrix}
\int_{-\infty}^{x} \frac{1}{2}e^x dx=\frac{1}{2}e^x,  &amp; x&lt;0; \\
\frac{1}{2}+\int_{0}^{x} \frac{1}{2}e^{-x}
dx=\frac{1}{2}-\frac{1}{2}(e^{-x}-1), &amp; x \ge0.
\end{matrix}\right.
\]</span> Since the random variable <span class="math inline">\(u=F_X(x)\)</span> follows a uniform distribution,
that is to say <span class="math inline">\(u\sim U(0,1)\)</span>, we can
calculate the corresponding inverse function as follows: when <span class="math inline">\(x &lt; 0\)</span>, <span class="math inline">\(F_X^{-1}(u)=\log(2u)\)</span>; when <span class="math inline">\(x \ge 0\)</span>, <span class="math inline">\(F_X^{-1}(u)=-\log(2-2u)\)</span>, that is to say
<span class="math display">\[
F_X^{-1}(u)=\left\{\begin{matrix}
\log(2u), &amp;0&lt;u \le \frac{1}{2}; \\
-\log(2-2u),  &amp; \frac{1}{2}&lt; u &lt;1.
\end{matrix}\right.
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u1)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>x2<span class="ot">=</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u2<span class="dv">-1</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(x1,x2)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="st">&quot;f(x)=1/2e^{-|x|}&quot;</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.55</span>))</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3.7" class="section level2">
<h2>Question 3.7</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a,b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<p>It can be seen from the meaning of the question that <span class="math inline">\(f(x)\)</span> follows Beta distribution, and the
probability density function of Beta distribution is as follows: <span class="math display">\[
f(x;a,b)=\frac{x^{a-1}(1-x)^{b-1}}{\int_0^1 u^{a-1}(1-u)^{b-1}du
}=\frac{1}{B(a,b)}x^{a-1}(1-x)^{b-1},
\]</span> among them, <span class="math display">\[
B(a,b)=\int_0^1 {x^{a-1}(1-x)^{b-1}}dx.
\]</span></p>
<p>According to the idea of accept-reject sampling method, the sample
<span class="math inline">\(X\)</span> from distribution <span class="math inline">\(f(x)\)</span> is inconvenient to extract, so we
can extract the sample <span class="math inline">\(Y\)</span> from
distribution <span class="math inline">\(g(x)\)</span>, and accept
sample <span class="math inline">\(Y=X\)</span> with the probability of
<span class="math inline">\(\rho=f(x)/(cg(x))\)</span>, where the
constant <span class="math inline">\(c&gt;1\)</span>, <span class="math inline">\(f(x) \le cg(x)\)</span>. Among them, <span class="math inline">\(g(x)\)</span> can be a uniformly distributed and
must envelop <span class="math inline">\(f(x)\)</span> function. We will
randomly generate samples <span class="math inline">\(Y\)</span> and
random values <span class="math inline">\(U\)</span> which follow <span class="math inline">\(g(x)\)</span> and a uniform distribution U(0,1)
respectively at the same time. If <span class="math inline">\(U \le
\rho\)</span>, the sample <span class="math inline">\(Y\)</span> is
accepted.</p>
<p>The function of accept-reject sampling is as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>rejacc_beta<span class="ot">=</span><span class="cf">function</span>(n,a,b){</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>j<span class="ot">=</span><span class="dv">0</span>; k<span class="ot">=</span><span class="dv">0</span>; y<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>j<span class="ot">=</span>j<span class="sc">+</span><span class="dv">1</span>;</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate u from U(0,1)</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate x from g(.)</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">&gt;</span>u) {</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>y[k]<span class="ot">=</span>x}</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>}</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">return</span>(y)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>}</span></code></pre></div>
<p>When <span class="math inline">\(a=3\)</span>, <span class="math inline">\(b\)</span>=2, we can calculate that</p>
<p><span class="math display">\[
B(3,2)=\int_0^1 {x^2(1-x)dx=\frac{1}{3}-\frac{1}{4}}=\frac{1}{12},
\]</span> and <span class="math display">\[
f(x;3,2)=12x^2(1-x).
\]</span></p>
<p>When a=3, b=2, n=1000, the corresponding sample probability density
histogram and theoretical probability density function diagram are as
follows:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3.9" class="section level2">
<h2>Question 3.9</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function
<span class="math display">\[
f_e(x)=\frac{3}{4}(1-x^2), \quad |x| \le 1  \tag{1}
\]</span> Devroye and Györfi give the following algorithm for simulation
from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3 ∼ Uniform(−1,1)\)</span>. If <span class="math inline">\(|U3|\ge|U2|\)</span> and <span class="math inline">\(|U3|\ge|U1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random
variates from <span class="math inline">\(f_e\)</span>, and construct
the histogram density estimate of a large simulated random sample.</p>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<p>First,we generate random variates from <span class="math inline">\(f(e)\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100000</span>  <span class="co"># a large simulated random sample</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>genefe<span class="ot">=</span><span class="cf">function</span>(n){</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>u1<span class="ot">=</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>u2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>u3<span class="ot">=</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>x<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="cf">if</span> ((<span class="fu">abs</span>(u3[i])<span class="sc">&gt;=</span><span class="fu">abs</span>(u2[i])) <span class="sc">&amp;&amp;</span> (<span class="fu">abs</span>(u3[i])<span class="sc">&gt;=</span><span class="fu">abs</span>(u1[i]))) {</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">cbind</span>(x,u2[i])</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">cbind</span>(x,u3[i])}</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>}</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>}</span></code></pre></div>
<p>Then, we will construct the histogram density estimate and the
theoretical probability density function of <span class="math inline">\(f_e(x)\)</span> under n=100000. <img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3.10" class="section level2">
<h2>Question 3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates
from the density <span class="math inline">\(f_e\)</span> (1).</p>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<p>It can be seen from the sample generation process in Question 3.9
that Y comes from the smallest and the second smallest sample values
which follow uniform distribution U(0,1). Since they are equally likely
to occur, so the probability of 0.5 is assigned respectively.</p>
<p>Since the distribution function of the <span class="math inline">\(k^{th}\)</span> order statistic <span class="math inline">\(x_{(k)}\)</span> is <span class="math display">\[
F_{x_{(k)}}(x)=\sum_{i=k}^{n} \frac{n!}{i!(n-i)!}
[F(x)]^i[1-F(x)]^{n-i},
\]</span> and <span class="math inline">\(Y=U_{(2)}+U_{(3)}\)</span>,
<span class="math inline">\(U \sim Uniform(0,1)\)</span>, n=3, we can
get that <span class="math display">\[
F_{U_{(1)}}(x)=\sum_{i=1}^{3}
\frac{3!}{i!(3-i)!}x^i(1-x)^{3-i}=3x(1-x)^2+3x^2(1-x)+x^3,
\]</span> and <span class="math display">\[
F_{U_{(2)}}(x)=\sum_{i=2}^{3}
\frac{3!}{i!(3-i)!}x^i(1-x)^{3-i}=3x^2(1-x)+x^3.
\]</span></p>
<p>The cumulative density function of <span class="math inline">\(Y\)</span> is <span class="math display">\[
F_Y(x)=\frac{1}{2}F_{U_{(1)}}(x)+\frac{1}{2}F_{U_{(2)}}(x)=\frac{3}{2}x(1-x)^2+3x^2(1-x)+x^3=-\frac{1}{2}x^3+\frac{3}{2}x,
\quad 0&lt;x&lt;1
\]</span> and the probability density function of <span class="math inline">\(Y\)</span> is <span class="math display">\[
f_Y(x)=F^{&#39;}_Y(x)=-\frac{3}{2}x^2+\frac{3}{2}, \quad 0&lt;x&lt;1.
\]</span> Since rescaled Epanechnikov kernel <span class="math inline">\(f_e(x)\)</span> is a symmetric distribution
defined on the interval [-1,1], we can get that <span class="math display">\[
f_e(x)=\frac{1}{2}f_Y(x)=-\frac{3}{4}x^2+\frac{3}{4}=\frac{3}{4}(1-x)^2,
\quad -1&lt;x&lt;1.
\]</span></p>
</div>
</div>
<div id="question-on-the-blackboard" class="section level2">
<h2>Question on the blackboard</h2>
<p>Write a function using the inverse transformation method to achieve
some of the function of sample.</p>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p>The purpose of <span class="math inline">\(sample(x,size=n,prob,replace)\)</span> is that
through the input vector <span class="math inline">\(x\)</span> and the
corresponding probability vector <span class="math inline">\(prob\)</span> to extract <span class="math inline">\(y\)</span> in the sample size of <span class="math inline">\(n\)</span>, also we can choose sampling method
with replacement or without replacement. First I write the function
“mysample” as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(base)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>mysample<span class="ot">=</span><span class="cf">function</span>(x, size, <span class="at">prob=</span><span class="cn">NULL</span>){</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.null</span>(prob)<span class="sc">==</span><span class="cn">TRUE</span>) prob<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x),<span class="fu">length</span>(x)) </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>             <span class="do">##Set the default to equal probability sampling</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>cp <span class="ot">=</span> <span class="fu">cumsum</span>(prob)  </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>U <span class="ot">=</span> <span class="fu">runif</span>(size)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>] <span class="co"># The inverse transform method</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">return</span>(r)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>}</span></code></pre></div>
<p>Then I will use two examples to illustrate the function of this
function. The first example is to take 10 samples in x={1,2,3,4} with
the probability of p=[0.1,0.2,0.3,0.4] with replacement.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>size<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>prob<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">mysample</span>(x,size, prob)   <span class="co">#Sampling results</span></span></code></pre></div>
<pre><code>##  [1] 2 4 3 4 4 1 3 4 3 3</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">mysample</span>(x,size, prob)) <span class="co"># collect sampling information</span></span></code></pre></div>
<pre><code>## 
## 1 2 3 4 
## 1 2 3 4</code></pre>
<p>The second example is to take 40 samples in x={a,b,c} with the
probability of p=[0.8,0.1,0.1)] with replacement.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>size<span class="ot">=</span><span class="dv">40</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>prob<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">mysample</span>(x,size,prob)  <span class="co">#Sampling results</span></span></code></pre></div>
<pre><code>##  [1] &quot;b&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot;
## [20] &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot; &quot;a&quot;
## [39] &quot;b&quot; &quot;a&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">mysample</span>(x,size,prob)) <span class="co"># collect sampling information</span></span></code></pre></div>
<pre><code>## 
##  a  b  c 
## 34  5  1</code></pre>
</div>
</div>
</div>
<div id="homework3-2023.9.25" class="section level1">
<h1>homework3 2023.9.25</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should take to minimize
the asymptotic variance of <span class="math inline">\(\widehat{\pi}\)</span> (m ∼ B(n,p), using <span class="math inline">\(\delta\)</span> method)</p>
<p>Take three different values of <span class="math inline">\(\rho\)</span> (<span class="math inline">\(0 \le
\rho \le 1\)</span>, including <span class="math inline">\(ρ_{min}\)</span>) and use Monte Carlo simulation
to verify your answer. (<span class="math inline">\(n=10^5\)</span>,
Number of repeated simulations <span class="math inline">\(K=100\)</span>)</p>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p>Suppose we need to perform n needle experiments, and the number of
successes is m, then <span class="math inline">\(m \sim B(n,p)\)</span>,
where m can be regarded as the sum of n random variables following the
binomial distribution. Let’s note <span class="math inline">\(\widehat{p}=\frac{m}{n}\)</span>. So, due to the
central limit theorem, we can get that <span class="math display">\[
\sqrt{n}(\widehat{p}-p)\overset{d}{\rightarrow} N(0,p(1-p)).
\]</span> Let’s note <span class="math inline">\(\rho=\frac{l}{d}\)</span>, <span class="math inline">\(\widehat{\pi}=\frac{2l}{d\widehat{p}}=\frac{2\rho}{\widehat{p}}\)</span>.
Due to the <span class="math inline">\(\delta\)</span> method, if <span class="math inline">\(\sqrt{n}(X_n-\theta)\overset{d}{\rightarrow}
N(0,\sigma^2)\)</span>, then <span class="math inline">\(\sqrt{n}(f(X_n)-f(\theta))\overset{d}{\rightarrow}
N(0,\sigma^2[{f}&#39;(\theta)]^2)\)</span>. We can get <span class="math inline">\(\theta=p\)</span>, <span class="math inline">\(\pi=f(p)=\frac{2\rho}{p}\)</span>, <span class="math inline">\([{f}&#39;(p)]^2=\frac{4\rho^2}{p^4}\)</span>,
and</p>
<p><span class="math display">\[
\sqrt{n}(\widehat{\pi}-\pi)\overset{d}{\rightarrow}
N(0,\frac{4\rho^2(1-p)}{p^3}).
\]</span> So</p>
<p><span class="math display">\[
avar(\widehat{\pi})=\frac{4\rho^2(1-p)}{p^3}=\frac{4(\pi p
/2)^2(1-p)}{p^3}=\frac{\pi^2(1-p)}{p}.
\]</span> Since <span class="math inline">\(\frac{1-p}{p}\)</span>
decreases with the increase of <span class="math inline">\(p\)</span>,
and <span class="math inline">\(0 \le p\le 1\)</span>, <span class="math inline">\(0 \le \rho\le 1\)</span>, when <span class="math inline">\(\rho_{min}=1\)</span>, <span class="math inline">\(avar(\widehat{\pi})\)</span> reaches the minimum
value.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>K<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>pihat1<span class="ot">=</span><span class="dv">0</span>; pihat2<span class="ot">=</span><span class="dv">0</span>; pihat3<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span><span class="sc">+</span>K)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>l1<span class="ot">=</span><span class="dv">1</span>; l2<span class="ot">=</span><span class="fl">1.5</span>; l3<span class="ot">=</span><span class="dv">2</span>; d<span class="ot">=</span><span class="dv">2</span>; </span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>rho1<span class="ot">=</span>l1<span class="sc">/</span>d</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>rho2<span class="ot">=</span>l2<span class="sc">/</span>d </span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>rho3<span class="ot">=</span>l3<span class="sc">/</span>d <span class="do">## rho_min</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e6</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>pihat1 <span class="ot">=</span> pihat1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>rho1<span class="sc">/</span><span class="fu">mean</span>(l1<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>pihat2 <span class="ot">=</span> pihat2 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>rho2<span class="sc">/</span><span class="fu">mean</span>(l2<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>pihat3 <span class="ot">=</span> pihat3 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>rho3<span class="sc">/</span><span class="fu">mean</span>(l3<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>}</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>pihat1<span class="sc">/</span>K; pihat2<span class="sc">/</span>K; pihat3<span class="sc">/</span>K</span></code></pre></div>
<pre><code>## [1] 3.137934</code></pre>
<pre><code>## [1] 3.145004</code></pre>
<pre><code>## [1] 3.144995</code></pre>
</div>
</div>
<div id="question-5.6" class="section level2">
<h2>Question 5.6</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[
\theta=\int_0^1e^xdx.
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U ,e^{1−U})\)</span> and <span class="math inline">\(Var(e^U + e^{1−U})\)</span>, where <span class="math inline">\(U \sim Uniform(0,1)\)</span>. What is the percent
reduction in variance of <span class="math inline">\(\widehat{\theta}_1\)</span> that can be achieved
using antithetic variates (compared with simple MC)?</p>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<p>Since <span class="math inline">\(e \approx 2.718282\)</span>, <span class="math inline">\(e-1 \approx 1.718282\)</span>. Assume that <span class="math inline">\(U \sim Un iform(0,1)\)</span>, we can derive that
<span class="math inline">\(E\left[e^U\right]=\int_0^1e^xdx=e-1\)</span>,
<span class="math inline">\(E\left[e^{1-U}\right]=-e\int_0^1e^{-x}dx=e-1\)</span>,
<span class="math inline">\(Var(e^U)=E(e^{2U})-[E(e^{U})]^2=\dfrac{e^2-1}{2}-(e-1)^2\)</span>,
<span class="math inline">\(Var(e^{1-U})=E(e^{2(1-U)})-[E(e^{1-U})]^2=\dfrac{e^2-1}{2}-(e-1)^2\)</span>.</p>
<p>Also, we can calculate that <span class="math display">\[
Cov\left(e^U, e^{1-U}\right)=E\left[e^U
e^{1-U}\right]-E\left[e^U\right]E\left[e^{(1-U)}\right]=e-(e-1)^2.
\]</span> and <span class="math display">\[
\begin{aligned}
Var\left(e^U+e^{1-U}\right)
&amp;=Var\left(e^U\right)+Var\left(e^{1-U}\right)+2Cov\left(e^U,
e^{1-U}\right) \\
&amp;=2 \times (\dfrac{e^2-1}{2}-(e-1)^2+e -(e-1)^2)\\
&amp;=2 \times (\dfrac{e^2-1}{2}-2(e-1)^2+e).
\end{aligned}
\]</span> Suppose both <span class="math inline">\(U_1\)</span> and
<span class="math inline">\(U_2\)</span> obey the uniform distribution
of <span class="math inline">\(Uniform(0,1)\)</span>, and <span class="math inline">\(\widehat{\theta}_1=\frac{e^{U_1}+e^{U_2}}{2}\)</span>
is the simple MC estimator, so the variance of the estimator <span class="math inline">\(\widehat{\theta}_1\)</span> is <span class="math display">\[
Var(\widehat{\theta}_1) = \dfrac{1}{4}(Var(e^{U_1})+Var(e^{U_2}))
=\frac{1}{2}( \frac{e^2-1}{2}-(e-1)^2) \approx 0.1210178.
\]</span> Suppose both <span class="math inline">\(V\)</span> and <span class="math inline">\(1-V\)</span> obey the uniform distribution of
<span class="math inline">\(Uniform(0,1)\)</span>, and <span class="math inline">\(\widehat{\theta}_2=\frac{e^{V}+e^{1-V}}{2}\)</span>
is the antithetic estimator, so the variance of the estimator <span class="math inline">\(\widehat{\theta}_2\)</span> is <span class="math display">\[
Var(\widehat{\theta}_2)=
Var\left( \frac{1}{2}
(e^V+e^{1-V})\right)=\frac{1}{4}Var\left(e^V+e^{1-V}\right)
= \frac{1}{2}\times (\dfrac{e^2-1}{2}-2(e-1)^2+e) \approx 0.003912498
\]</span></p>
<p>So the reduction in variance is <span class="math display">\[
\frac{Var\left(\widehat{\theta}_1\right)-Var\left(\widehat{\theta}_2\right)}{Var\left(\widehat{\theta}_1\right)}
= 0.9676701
\]</span> Therefore, the reduction in variance is 96.767%.</p>
</div>
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<p>According to the analysis of question 5.6, we can give the following
simulation process.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>MCjf <span class="ot">=</span> <span class="cf">function</span>(R, antithetic) </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>{</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>) <span class="do">##Generate random numbers Xi from the uniform distrubution U(0,1), i = 1,...,m/2</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="cf">if</span> (antithetic<span class="sc">==</span><span class="cn">TRUE</span>) {v<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>u} <span class="do">##calucate Yi = 1 - Xi, i = 1,...,m/2</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="cf">else</span> {v<span class="ot">=</span><span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)} <span class="do">##Generate random numbers Xi from the uniform distrubution U(0,1), i = m/2+1,...,m</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">c</span>(u, v)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  g <span class="ot">=</span> <span class="fu">exp</span>(u) </span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">mean</span>(g))</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>}</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">10000</span>  <span class="do">##the number of simulations</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>MC1<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">nrow=</span>m)  <span class="do">## the simple Monte Carlo method</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>MC2<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">nrow=</span>m)  <span class="do">## the antithetic variate approach</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span><span class="sc">+</span>i)</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>  MC1[i] <span class="ot">=</span> <span class="fu">MCjf</span>(<span class="at">R =</span> m, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>  MC2[i] <span class="ot">=</span> <span class="fu">MCjf</span>(<span class="at">R =</span> m, <span class="at">antithetic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>}</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="fu">var</span>(MC1); <span class="fu">var</span>(MC2); (<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1)</span></code></pre></div>
<pre><code>##              [,1]
## [1,] 2.426883e-05</code></pre>
<pre><code>##              [,1]
## [1,] 7.885501e-07</code></pre>
<pre><code>##           [,1]
## [1,] 0.9675077</code></pre>
<p>Under 10^{4} times simulation experiment, the result of 0.9675077 is
similar to the reduction in variance of question 5.6.</p>
</div>
</div>
</div>
<div id="homework4-2023.10.9" class="section level1">
<h1>homework4 2023.10.9</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Assume that there are a total of <span class="math inline">\(M=km\)</span> samples, divided into <span class="math inline">\(k\)</span> layers, and each layer has <span class="math inline">\(m_1=\dots=m_k=m\)</span> samples.</p>
<p>The stratified estimation can be expressed as <span class="math display">\[
\widehat{\theta}^S=\frac{1}{km} \sum_{i=1}^{k}\sum_{j=1}^{m} g(U_{ji}),
\quad U_{ji}\sim(a,b),
\]</span> The corresponding variance is <span class="math display">\[
var(\widehat{\theta}^S)=\frac{1}{kM} \sum_{i=1}^{k}\sigma_i^2.
\]</span> A simple estimate can be expressed as <span class="math display">\[
\widehat{\theta}^M=\frac{1}{M} \sum_{i=1}^{M} g(U_i), \quad
U_i\sim(a,b),
\]</span> The corresponding variance is <span class="math display">\[
\begin{align}
var(\widehat{\theta}^M)=\frac{1}{M}
\sum_{i=1}^{k}var(g(U))&amp;=\frac{1}{M}\left\{
E[var(g(U)|I]+var[E(g(U)|I]\right\}\\
&amp;=\frac{1}{M}\left\{ E(\sigma_I^2)+var(\theta_I)\right\}\\
&amp;=\frac{1}{M} \left\{ \frac{1}{k}
\sum_{i=1}^{k}\sigma_i^2+var(\theta_I)\right\}\\
&amp;=var(\widehat{\theta}^S)+ \frac{1}{M}var(\theta_I).
\end{align}
\]</span> When <span class="math inline">\((b_i-a_i) \to 0\)</span>,
<span class="math inline">\(\sigma_i^2 \to 0\)</span>. Assume that <span class="math inline">\(M\)</span> is a constant，when <span class="math inline">\(m\to 0\)</span>, <span class="math inline">\(k \to
\infty\)</span>, <span class="math inline">\(\frac{1}{k}
\sum_{i=1}^{k}\sigma_i^2 \le max \left\{\sigma_i^2 \right\} \to
0\)</span>, so <span class="math inline">\(var(\widehat{\theta}^S) \to
0\)</span>, <span class="math inline">\(var(\widehat{\theta}^M) \to
\frac{1}{M}var(\theta_I)\)</span>, and <span class="math inline">\(var(\widehat{\theta}^S)/var(\widehat{\theta}^M)
\to 0\)</span>.</p>
</div>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[ g(x)=\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2},
\quad x&gt;1.\]</span> Which of your two importance functions should
produce the smaller variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling? Explain.</p>
<div id="answer-8" class="section level3">
<h3>Answer</h3>
<p>Importance sampling requires that we find a suitable probability
density function f(x), such that the ratio of the objective function
g(x) to f(x) tends to a constant, and the sample <span class="math inline">\(X\)</span> from the density function f(x) is
convenient to sample.</p>
<p>Firstly, according to the formula of <span class="math inline">\(g(x)\)</span>, I choose the function <span class="math inline">\(f_1(x)
=2*\frac{1}{\sqrt{2\pi}}e^{-(x-1)^2/2}\)</span>, which is symmetric
about 1 and the function <span class="math inline">\(f_2(x)=2*\frac{\Gamma(3/2)}{\Gamma(1)\sqrt{2\pi}}(1+(x-1)^2/2)^{-3/2}\)</span>,
which is symmetric about 1. It can be found that the integral of <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> on <span class="math inline">\((1,\infty)\)</span> is 1, so they are probability
density functions. The former is based on the improvement of the
probability density function of the normal distribution <span class="math inline">\(N(1,1)\)</span>, while the latter is based on the
probability density function of the <span class="math inline">\(t(2)\)</span> distribution with 1 as the symmetry
axis. Then I display the graph of <span class="math inline">\(g(x)\)</span>, <span class="math inline">\(f_1(x)\)</span>, <span class="math inline">\(f_2(x)\)</span>. From the graph below, we can see
the two importance functions <span class="math inline">\(f_1(x)\)</span>
and <span class="math inline">\(f_2(x)\)</span> that are supported on
<span class="math inline">\((1, \infty)\)</span> are ‘close’ to <span class="math inline">\(g(x)\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="do">##构建函数f1与f2</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>}</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">*</span><span class="fu">factorial</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="do">##自由度为n时 2*factorial((n+1)/2-1)/(factorial(n/2-1)*sqrt(pi*n))*(1+(x-1)^2/n)^(-(n+1)/2)</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>}</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>intf1<span class="ot">=</span><span class="fu">integrate</span>(f1, <span class="dv">1</span>, <span class="cn">Inf</span>) <span class="co">#积分结果为1，说明可以作为概率密度函数</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>intf2<span class="ot">=</span><span class="fu">integrate</span>(f2, <span class="dv">1</span>, <span class="cn">Inf</span>) <span class="co">#积分结果为1，说明可以作为概率密度函数</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="fl">0.01</span>)</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>y <span class="ot">=</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) </span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="at">mean =</span> <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>f2<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span><span class="fu">factorial</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="fu">lines</span>(x, f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Next, we’ll compare the ratio of <span class="math inline">\(g(x)/f(x)\)</span> to see which of these two
important functions should produce the smaller variance in the estimate
<span class="math inline">\(\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}}
e^{-x^2 / 2} dx\)</span>. From the figure below, they are very close,
but at <span class="math inline">\(x&lt;10\)</span>, the <span class="math inline">\(g(x)/f_1(x)\)</span> function declines more slowly
and more gently, so it can be considered that the ratio <span class="math inline">\(g(x)/f_1(x)\)</span> is closer to an constant.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="fl">0.01</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">plot</span>(x, y<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">1</span>)), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>f2<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span><span class="fu">factorial</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="fu">lines</span>(x, y<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g/f1&quot;</span>, <span class="st">&quot;g/f2&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="question-5.14" class="section level2">
<h2>Question 5.14</h2>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} dx
\]</span> by importance sampling.</p>
<div id="answer-9" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e5</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>est <span class="ot">=</span> sd <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>}</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#f1</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(m,<span class="at">mean=</span><span class="dv">1</span>) </span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>result1 <span class="ot">=</span> <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">1</span>))</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>est[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">mean</span>(result1)</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>sd[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">sd</span>(result1)</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#f2</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">runif</span>(m,<span class="dv">1</span>,<span class="dv">100</span>) </span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>f2<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span><span class="fu">factorial</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>result2 <span class="ot">=</span> <span class="fu">g</span>(x)<span class="sc">/</span>f2</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>est[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">mean</span>(result2)</span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>sd[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">sd</span>(result2)</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="fu">rbind</span>(est,sd)</span></code></pre></div>
<pre><code>##          [,1]       [,2]
## est 0.4951572 0.01115789
## sd  2.1741397 0.06898256</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">integrate</span>(<span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x), <span class="dv">1</span>, <span class="cn">Inf</span>)<span class="sc">$</span>value <span class="do">##g(x)的真实值</span></span></code></pre></div>
<pre><code>## [1] 0.400626</code></pre>
<p>From the results above, we may prefer to think that <span class="math inline">\(f_1\)</span> will produce smaller variance
0.0111579 in estimating. At the same time, its estimated value is closer
to the real value, so we choose <span class="math inline">\(f_1(x)
=2*\frac{1}{\sqrt{2\pi}}e^{-(x-1)^2/2}\)</span> as the importance
function to estimate</p>
</div>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<p>Our aim is to estimate <span class="math inline">\(\int _{0}^{1}
e^{−t}/(1 + t^2)dt\)</span>. The integration with simple stratified
sampling can be written as <span class="math display">\[
\int_0^1 \frac{e^{−t}}{1 + t^2}dt=\frac{1}{k}
\sum\limits_{i=1}^{k}\int_{(i-1)/k}^{i/k} \frac{ke^{−t}}{1 + t^2}dt=
\frac{1}{k}\sum\limits_{i=1}^{k}E(\frac{e^{−X_{i}}}{1 + X_{i}^2}),
\]</span> where <span class="math inline">\(X \sim U((i − 1)/k,
i/k)\)</span>. Due to the importance function is <span class="math inline">\(f(x) = e^{−x}/( 1 − e^{−1})\)</span>, <span class="math inline">\(0&lt;x&lt;1\)</span>. Since the distribution
function of <span class="math inline">\(X\)</span> is <span class="math inline">\(F(x)=\frac{1-e^{-x}}{1-e^{-1}}\)</span>, <span class="math inline">\(x=-\log(1-(1-e^{-1})F(x))\)</span> can be obtained
by the inverse transformation. We set k subintervals <span class="math inline">\((a_{j-1} , a_{j})\)</span>, <span class="math inline">\(j = 1,2,\dots,k\)</span>. Therefore, on the jth
subinterval, <span class="math display">\[
f_{j}(x)=\frac{ke^{−x}}{ 1 − e^{−1}}, \quad a_{j-1} &lt;x&lt; a_{j},
\]</span></p>
<p>where <span class="math inline">\(a_{j}=F^{-1}(\frac{j}{k})=-log(1-\frac{j}{k}(1-e^{-1}))\)</span>.
Then we have the stratified importance sampling <span class="math display">\[
\int_0^1 \frac{e^{−t}}{1 + t^2}dt
=\sum\limits_{i=1}^{k}\int_{a_{i-1}}^{a_i} g(x) dx
=\sum\limits_{i=1}^{k}E(g(X)/f_{i}(X)),
\]</span> where <span class="math inline">\(X \sim f_{i}(x)\)</span>,
<span class="math inline">\(g(x)=e^{−x}/(1 + x^2)\)</span>(<span class="math inline">\(0&lt;x&lt;1\)</span>).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a> n <span class="ot">=</span> <span class="dv">10000</span>  </span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a> k <span class="ot">=</span> <span class="dv">5</span>  <span class="co">#分成5层</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a> m <span class="ot">=</span> n<span class="sc">/</span>k </span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">numeric</span>(k)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>var <span class="ot">=</span> <span class="fu">numeric</span>(k)</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>sd <span class="ot">=</span> <span class="fu">numeric</span>(k) </span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a> </span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a> g <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a> f <span class="ot">=</span> <span class="cf">function</span>(x) k<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a> u <span class="ot">=</span> <span class="fu">runif</span>(m, (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>k, j<span class="sc">/</span>k)</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a> x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> u) <span class="co"># 由逆变换方法得到对应的值</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a> result <span class="ot">=</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a> theta[j] <span class="ot">=</span> <span class="fu">mean</span>(result)</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>  var[j] <span class="ot">=</span> <span class="fu">var</span>(result)</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>  sd[j] <span class="ot">=</span> <span class="fu">sd</span>(result)</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a> }</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a><span class="fu">sum</span>(theta)</span></code></pre></div>
<pre><code>## [1] 0.5250139</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">mean</span>(var)</span></code></pre></div>
<pre><code>## [1] 1.704006e-05</code></pre>
<p>Without stratification :</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a> n <span class="ot">=</span> <span class="dv">10000</span>  </span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a> k <span class="ot">=</span> <span class="dv">1</span>  <span class="co">#不分层</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a> m <span class="ot">=</span> n<span class="sc">/</span>k </span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>theta1 <span class="ot">=</span> <span class="fu">numeric</span>(k)</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>var1 <span class="ot">=</span> <span class="fu">numeric</span>(k)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>sd1 <span class="ot">=</span> <span class="fu">numeric</span>(k) </span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a> </span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a> g <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a> f <span class="ot">=</span> <span class="cf">function</span>(x) k<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a> u <span class="ot">=</span> <span class="fu">runif</span>(m, (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>k, j<span class="sc">/</span>k)</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a> x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> u) <span class="co"># 由逆变换方法得到对应的值</span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a> result <span class="ot">=</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a> theta1[j] <span class="ot">=</span> <span class="fu">mean</span>(result)</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>  var1[j] <span class="ot">=</span> <span class="fu">var</span>(result)</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>  sd1[j] <span class="ot">=</span> <span class="fu">sd</span>(result)</span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a> }</span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a><span class="fu">sum</span>(theta1)</span></code></pre></div>
<pre><code>## [1] 0.5259499</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">mean</span>(var1)</span></code></pre></div>
<pre><code>## [1] 0.009200805</code></pre>
<p>Comparing with the two methods above, we can conclude that when we
use stratification, the estimate is <span class="math inline">\(\hat{θ}_{sub}\)</span> = 0.5250139 and variance
extremely reduced to 1.7040058^{-5}. However, when we don’t use
stratification, the estimate is <span class="math inline">\(\hat{θ}\)</span> = 0.5259499 and variance is
0.0092008.</p>
<p>In Example <span class="math inline">\(5.10\)</span> our best result
was obtained with importance function <span class="math inline">\(f(x)=\)</span> <span class="math inline">\(e^{-x}
/\left(1-e^{-1}\right), 0&lt;x&lt;1\)</span>. From 10000 replicates we
obtained the estimate <span class="math inline">\(\hat{\theta}=0.5257801\)</span> and an estimated
standard error <span class="math inline">\(0.0970314\)</span>. As a
result, we can make a conclusion that by using the stratified importance
sampling with total 10000 replicates can obtain the closer estimate
<span class="math inline">\(\hat{\theta}\)</span>=0.5250139 to Example
<span class="math inline">\(5.10\)</span> and an estimated standard
error 0.004128 which is far less than <span class="math inline">\(0.0970314\)</span> in Example <span class="math inline">\(5.10\)</span>.</p>
</div>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but
the sample data are non-normal. Then the probability that the confidence
interval covers the mean is not necessarily equal to 0.95. Use a Monte
Carlo experiment to estimate the coverage probability of the t-interval
for random samples of <span class="math inline">\(\chi^2(2)\)</span>
data with sample size n = 20. Compare your t-interval results with the
simulation results in Example 6.4. (The t-interval should be more robust
to departures from normality than the interval for variance.)</p>
<div id="answer-11" class="section level3">
<h3>Answer</h3>
<p>Since <span class="math inline">\(\frac{\bar{x}-\mu}{s/\sqrt{n}} \sim
N(0,1)\)</span>, the t-interval of <span class="math inline">\(\mu\)</span> is <span class="math inline">\([\bar{x}-t_{n-1}(\alpha/2)s/\sqrt{n},\bar{x}+t_{n-1}(\alpha/2)s/\sqrt{n}]\)</span>.
Due to <span class="math inline">\(X \sim \chi^2(2)\)</span>, the mean
of <span class="math inline">\(X\)</span> is 2, so we will calculate the
probability that the confidence interval covers the true value 2.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>CIl<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>CIr<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="do">## sample size</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a> t0 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)  <span class="co">#t_{n-1}(\alpha/2), alpha=0.5</span></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>x <span class="ot">&lt;-</span><span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>CIl[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span>t0<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)  <span class="co"># Lower bound of the interval</span></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>CIr[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span>t0<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)  <span class="co"># Upper bound of the interval</span></span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>}</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a> <span class="fu">sum</span>(CIl <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> CIr <span class="sc">&gt;</span> <span class="dv">2</span>)  <span class="co">#The mean of the chi-square distribution χ2(2) is 2</span></span></code></pre></div>
<pre><code>## [1] 9232</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a> <span class="fu">mean</span>(CIl <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> CIr <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9232</code></pre>
<p>The t-interval is more robust to departures from normality than the
interval for variance. For the <span class="math inline">\(\chi^2(2)\)</span> distribution the empirical
coverage rate was only 77.3%.</p>
</div>
</div>
<div id="question-6.a" class="section level2">
<h2>Question 6.A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the t-test is approximately equal to the nominal
significance level <span class="math inline">\(\alpha\)</span>, when the
sampled population is non-normal. The t-test is robust to mild
departures from normality. Discuss the simulation results for the cases
where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii)
Exponential(rate=1). In each case, test <span class="math inline">\(H_0
: µ = µ_0\)</span> vs <span class="math inline">\(H_0 : µ \ne
µ_0\)</span> , where <span class="math inline">\(µ_0\)</span> is the
mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2),
and Exponential(1), respectively.</p>
<div id="answer-12" class="section level3">
<h3>Answer</h3>
<p>The mean of <span class="math inline">\(\chi^2(1)\)</span>,
Uniform(0,2), and Exponential(1) are all 1, so the mean <span class="math inline">\(µ_0\)</span> only needs to be tested against 1.
Since <span class="math inline">\(\frac{\bar{x}-\mu_0}{s/\sqrt{n}} \sim
t(n-1)\)</span>, the p-value is <span class="math inline">\(2*Pr\left(|\frac{\bar{x}-\mu_0}{s/\sqrt{n}}|&gt;t_{\alpha/2}(n-1)
\right)\)</span>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>m <span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e3</span>  </span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span> </span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>pval1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,m)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>pval2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,m)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>pval3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,m)</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(i<span class="sc">+</span><span class="dv">123</span>)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>  xchi <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>  xuni <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>  xexp <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  t01<span class="ot">=</span><span class="fu">abs</span>(<span class="fu">mean</span>(xchi)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">sd</span>(xchi)<span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  t02<span class="ot">=</span><span class="fu">abs</span>(<span class="fu">mean</span>(xuni)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">sd</span>(xuni)<span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>  t03<span class="ot">=</span><span class="fu">abs</span>(<span class="fu">mean</span>(xexp)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">sd</span>(xexp)<span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>  pval1[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="dv">1</span><span class="sc">-</span>t01,n<span class="dv">-1</span>)</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>  pval2[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="dv">1</span><span class="sc">-</span>t02,n<span class="dv">-1</span>)</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>  pval3[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="dv">1</span><span class="sc">-</span>t03,n<span class="dv">-1</span>)</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>}</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(pval1<span class="sc">&lt;=</span>alpha),<span class="fu">mean</span>(pval2<span class="sc">&lt;=</span>alpha),<span class="fu">mean</span>(pval3<span class="sc">&lt;=</span>alpha))</span></code></pre></div>
<pre><code>## [1] 0.0045 0.0031 0.0031</code></pre>
</div>
</div>
</div>
<div id="homework5-2023.10.16" class="section level1">
<h1>Homework5 2023.10.16</h1>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>Suppose there are <span class="math inline">\(m\)</span> hypothesis
tests, <span class="math inline">\(m_0\)</span> null hypotheses are
true, <span class="math inline">\(R\)</span> null hypotheses are
rejected, the number of Type I errors made is <span class="math inline">\(V\)</span>, and reject <span class="math inline">\(S\)</span> times false null hypotheses, then <span class="math inline">\(FWER=V/m0\)</span>, <span class="math inline">\(FDR=V/R\)</span>, <span class="math inline">\(TPR=S/(m-m0)\)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span> <span class="co">#有1000个原假设</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>m0<span class="ot">=</span><span class="dv">950</span> <span class="co">#前95%个原假设为真</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>B<span class="ot">=</span><span class="dv">1000</span> <span class="co">#重复次数</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.1</span> <span class="co">#显著性水平</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>V1<span class="ot">=</span><span class="dv">0</span>;  V2<span class="ot">=</span><span class="dv">0</span>; FDR_1<span class="ot">=</span><span class="dv">0</span>; FDR_2<span class="ot">=</span><span class="dv">0</span>; TPR_1<span class="ot">=</span><span class="dv">0</span>; TPR_2<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>p0<span class="ot">=</span><span class="fu">runif</span>(m0,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">rbeta</span>(m<span class="sc">-</span>m0,<span class="at">shape1=</span><span class="fl">0.1</span>,<span class="at">shape2=</span><span class="dv">1</span>)</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">c</span>(p0,p1)</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a><span class="do">##Bonferroni校正</span></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>pb<span class="ot">=</span><span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)  <span class="co">#所有p值得放在一起校正</span></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>pb0<span class="ot">=</span>pb[<span class="dv">1</span><span class="sc">:</span>m0]</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>pb1<span class="ot">=</span>pb[(m0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a><span class="do">##B-H校正, 也就是FDR校正</span></span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>ph<span class="ot">=</span><span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)  <span class="co">#所有p值得放在一起校正</span></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>ph0<span class="ot">=</span>ph[<span class="dv">1</span><span class="sc">:</span>m0]</span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>ph1<span class="ot">=</span>ph[(m0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">sum</span>(pb0<span class="sc">&lt;=</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span>) {V1<span class="ot">=</span>V1<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">sum</span>(ph0<span class="sc">&lt;=</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span>) {V2<span class="ot">=</span>V2<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a>FDR_1<span class="ot">=</span>FDR_1<span class="sc">+</span><span class="fu">sum</span>(pb0<span class="sc">&lt;=</span>alpha)<span class="sc">/</span>(<span class="fu">sum</span>(pb0<span class="sc">&lt;=</span>alpha)<span class="sc">+</span><span class="fu">sum</span>(pb1<span class="sc">&lt;=</span>alpha))</span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a>FDR_2<span class="ot">=</span>FDR_2<span class="sc">+</span><span class="fu">sum</span>(ph0<span class="sc">&lt;=</span>alpha)<span class="sc">/</span>(<span class="fu">sum</span>(ph0<span class="sc">&lt;=</span>alpha)<span class="sc">+</span><span class="fu">sum</span>(ph1<span class="sc">&lt;=</span>alpha))</span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a>TPR_1<span class="ot">=</span>TPR_1<span class="sc">+</span><span class="fu">sum</span>(pb1<span class="sc">&lt;=</span>alpha)<span class="sc">/</span>(m<span class="sc">-</span>m0)</span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a>TPR_2<span class="ot">=</span>TPR_2<span class="sc">+</span><span class="fu">sum</span>(ph1<span class="sc">&lt;=</span>alpha)<span class="sc">/</span>(m<span class="sc">-</span>m0)</span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a>}</span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a>FWER_1<span class="ot">=</span>V1<span class="sc">/</span>B</span>
<span id="cb43-31"><a href="#cb43-31" tabindex="-1"></a>FWER_2<span class="ot">=</span>V2<span class="sc">/</span>B</span>
<span id="cb43-32"><a href="#cb43-32" tabindex="-1"></a>FDR_1<span class="ot">=</span>FDR_1<span class="sc">/</span>B</span>
<span id="cb43-33"><a href="#cb43-33" tabindex="-1"></a>FDR_2<span class="ot">=</span>FDR_2<span class="sc">/</span>B</span>
<span id="cb43-34"><a href="#cb43-34" tabindex="-1"></a>TPR_1<span class="ot">=</span>TPR_1<span class="sc">/</span>B</span>
<span id="cb43-35"><a href="#cb43-35" tabindex="-1"></a>TPR_2<span class="ot">=</span>TPR_2<span class="sc">/</span>B</span>
<span id="cb43-36"><a href="#cb43-36" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" tabindex="-1"></a>ans<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb43-38"><a href="#cb43-38" tabindex="-1"></a>ans[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">=</span>FWER_1; ans[<span class="dv">2</span>,<span class="dv">1</span>]<span class="ot">=</span>FWER_2;</span>
<span id="cb43-39"><a href="#cb43-39" tabindex="-1"></a>ans[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">=</span>FDR_1; ans[<span class="dv">2</span>,<span class="dv">2</span>]<span class="ot">=</span>FDR_2;</span>
<span id="cb43-40"><a href="#cb43-40" tabindex="-1"></a>ans[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">=</span>TPR_1; ans[<span class="dv">2</span>,<span class="dv">3</span>]<span class="ot">=</span>TPR_2;</span>
<span id="cb43-41"><a href="#cb43-41" tabindex="-1"></a><span class="fu">colnames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>,<span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb43-42"><a href="#cb43-42" tabindex="-1"></a><span class="fu">rownames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonf&quot;</span>,<span class="st">&quot;BH&quot;</span>)</span>
<span id="cb43-43"><a href="#cb43-43" tabindex="-1"></a>ans</span></code></pre></div>
<pre><code>##       FWER         FDR     TPR
## Bonf 0.095 0.004757647 0.39836
## BH   0.932 0.092276693 0.56138</code></pre>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>bootstrapjf<span class="ot">=</span><span class="cf">function</span>(n)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>{</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>lambda<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>B<span class="ot">=</span><span class="dv">1000</span>  <span class="co"># number of bootstrap replicates</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span>  <span class="co"># repeated times</span></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>bias <span class="ot">&lt;-</span> se.boot <span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span><span class="sc">+</span>i)</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(n, <span class="at">rate=</span>lambda)</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>lambdahatstar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>lambdahat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x); <span class="co">#要估计的lambda是1/\bar{x}</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>lambdahatstar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar) <span class="co">#要估计的lambda是1/\bar{x}</span></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>}</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>bias[i]<span class="ot">=</span><span class="fu">mean</span>(lambdahatstar)<span class="sc">-</span>lambdahat</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>se.boot[i]<span class="ot">=</span><span class="fu">sd</span>(lambdahatstar)</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>}</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">bias=</span><span class="fu">mean</span>(bias),<span class="at">se.boot=</span><span class="fu">mean</span>(se.boot),<span class="at">bias_theotical=</span>lambda<span class="sc">/</span>(n<span class="dv">-1</span>),<span class="at">se.boot_theotical=</span>lambda<span class="sc">*</span>n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))))</span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>}</span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>ans1<span class="ot">=</span><span class="fu">bootstrapjf</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>ans2<span class="ot">=</span><span class="fu">bootstrapjf</span>(<span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a>ans3<span class="ot">=</span><span class="fu">bootstrapjf</span>(<span class="at">n=</span><span class="dv">20</span>)</span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a>ans<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">5</span>,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>ans[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">=</span><span class="dv">5</span>; ans[<span class="dv">2</span>,<span class="dv">1</span>]<span class="ot">=</span><span class="dv">10</span>; ans[<span class="dv">3</span>,<span class="dv">1</span>]<span class="ot">=</span><span class="dv">20</span>;</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a>ans[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">=</span>ans1<span class="sc">$</span>bias; ans[<span class="dv">1</span>,<span class="dv">4</span>]<span class="ot">=</span>ans1<span class="sc">$</span>se.boot; ans[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">=</span>ans1<span class="sc">$</span>bias_theotical; ans[<span class="dv">1</span>,<span class="dv">5</span>]<span class="ot">=</span>ans1<span class="sc">$</span>se.boot_theotical;</span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a>ans[<span class="dv">2</span>,<span class="dv">2</span>]<span class="ot">=</span>ans2<span class="sc">$</span>bias; ans[<span class="dv">2</span>,<span class="dv">4</span>]<span class="ot">=</span>ans2<span class="sc">$</span>se.boot; ans[<span class="dv">2</span>,<span class="dv">3</span>]<span class="ot">=</span>ans2<span class="sc">$</span>bias_theotical; ans[<span class="dv">2</span>,<span class="dv">5</span>]<span class="ot">=</span>ans2<span class="sc">$</span>se.boot_theotical;</span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a>ans[<span class="dv">3</span>,<span class="dv">2</span>]<span class="ot">=</span>ans3<span class="sc">$</span>bias; ans[<span class="dv">3</span>,<span class="dv">4</span>]<span class="ot">=</span>ans3<span class="sc">$</span>se.boot; ans[<span class="dv">3</span>,<span class="dv">3</span>]<span class="ot">=</span>ans3<span class="sc">$</span>bias_theotical; ans[<span class="dv">3</span>,<span class="dv">5</span>]<span class="ot">=</span>ans3<span class="sc">$</span>se.boot_theotical;</span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a><span class="fu">colnames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;Bias_bootstrap&quot;</span>,<span class="st">&quot;Bias_theoretical&quot;</span>,<span class="st">&quot;SE_bootstrap&quot;</span>,<span class="st">&quot;SE_theoretical&quot;</span>)</span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a>ans</span></code></pre></div>
<pre><code>##       n Bias_bootstrap Bias_theoretical SE_bootstrap SE_theoretical
## [1,]  5     0.55349758        0.5000000    2.1088830      1.4433757
## [2,] 10     0.21046180        0.2222222    0.7947923      0.7856742
## [3,] 20     0.09875247        0.1052632    0.4861356      0.4962153</code></pre>
<p>It can be seen that with the increase of sample size, Bias and SE
become smaller and smaller, and the gap between their bootstrap estimate
and theoretical value also becomes smaller and smaller.</p>
</div>
<div id="question-7.3" class="section level2">
<h2>Question 7.3</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (law data in bootstrap)</p>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<p>Taking the existing sample as <span class="math inline">\(X\)</span>
and <span class="math inline">\(Y\)</span>, we can find the confidence
interval by following these steps:</p>
<p>1、Calculate <span class="math inline">\(\hat{\theta}=cor(X,Y)\)</span></p>
<p>2、Let <span class="math inline">\(B=1000\)</span>, for <span class="math inline">\(j=1,2,\dots,B\)</span>, from <span class="math inline">\(1,2,\dots,n\)</span> to extract n Numbers with
replacement, then get <span class="math inline">\(i_{1j},i_{2j},\dots,i_{nj}\)</span>. Record the
corresponding <span class="math inline">\(X_j^*=(X^*_{i_{1j}},X^*_{i_{2j}},\dots,X^*_{i_{nj}})\)</span>
and <span class="math inline">\(Y_j^*=(Y^*_{i_{1j}},Y^*_{i_{2j}},\dots,Y^*_{i_{nj}})\)</span>.
Calculate the corresponding <span class="math inline">\(\hat{\theta}_j^*=cor(X_j^*,Y_j^*)\)</span> and
<span class="math inline">\(\hat{se}(\hat{\theta})=\sqrt{\frac{1}{B-1}\sum_{j=1}^{B}(\hat{\theta}_j^*-\bar{\hat{\theta}}_j^*)^2}\)</span>.</p>
<p>3、Calculate the quantile of <span class="math inline">\(t^*\)</span>. For <span class="math inline">\(i=1,2,\dots,B\)</span>, calculate <span class="math inline">\((\hat{\theta}^*-\hat{\theta})/\hat{se}(\hat{\theta}^*)\)</span>
respectively, and put them in the array <span class="math inline">\(t^*\)</span>, where <span class="math inline">\(\hat{se}(\hat{\theta}^*)\)</span> is a standard
deviation estimated based on second sampling from the <span class="math inline">\(X_j^*=(X^*_{i_{1j}},X^*_{i_{2j}},\dots,X^*_{i_{nj}})\)</span>
and <span class="math inline">\(Y_j^*=(Y^*_{i_{1j}},Y^*_{i_{2j}},\dots,Y^*_{i_{nj}})\)</span>.</p>
<p>4、Let <span class="math inline">\(\alpha=0.5\)</span>, calculate
<span class="math inline">\(t_{1-\alpha/2}^*\)</span> and <span class="math inline">\(t_{\alpha/2}^*\)</span> respectively.</p>
<p>The studentized bootstrap CI (student) is <span class="math display">\[
\left[
\hat{\theta}-t_{1-\alpha/2}^*\hat{se}(\hat{\theta}),\hat{\theta}-t_{\alpha/2}^*\hat{se}(\hat{\theta})
\right]
\]</span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap) <span class="co">#for the law data</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>x<span class="ot">=</span>law<span class="sc">$</span>LSAT</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>y<span class="ot">=</span>law<span class="sc">$</span>GPA</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>thetahat<span class="ot">=</span><span class="fu">cor</span>(x,y)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">NROW</span>(x)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>B<span class="ot">=</span><span class="dv">1000</span>  <span class="co"># number of bootstrap replicates</span></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span>  <span class="co"># number of  second order bootstrap replicates</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>t <span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>thetahatstar <span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>bh <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>xstar <span class="ot">&lt;-</span> x[bh]</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>ystar <span class="ot">&lt;-</span> y[bh]</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>thetahatstar[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(xstar,ystar) </span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>thetahatstarstar <span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>bhstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>xstarstar <span class="ot">&lt;-</span> xstar[bhstar]</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>ystarstar <span class="ot">&lt;-</span> ystar[bhstar]</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>thetahatstarstar[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(xstarstar,ystarstar) </span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a>}</span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>t[b]<span class="ot">=</span>(thetahatstar[b]<span class="sc">-</span>thetahat)<span class="sc">/</span><span class="fu">sd</span>(thetahatstarstar) <span class="co">#计算t值</span></span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a>}</span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>t_l<span class="ot">=</span><span class="fu">quantile</span>(t, <span class="at">probs=</span><span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>t_r<span class="ot">=</span><span class="fu">quantile</span>(t, <span class="at">probs=</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>CL<span class="ot">=</span>thetahat<span class="sc">-</span>t_l<span class="sc">*</span><span class="fu">sd</span>(thetahatstar)</span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>CR<span class="ot">=</span>thetahat<span class="sc">-</span>t_r<span class="sc">*</span><span class="fu">sd</span>(thetahatstar)</span></code></pre></div>
<p>Therefore, the bootstrap confidence interval for the relevant
statistic in Example 7.2 is estimated as [-0.2643723,0.998049].</p>
</div>
</div>
</div>
<div id="homework6-2023.10.23" class="section level1">
<h1>Homework6 2023.10.23</h1>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div id="answer-14" class="section level3">
<h3>Answer</h3>
<p>Refer to the air-conditioning data set “aircondit” provided in the
boot package. Assume that the times between failures follow an
exponential model <span class="math inline">\(Exp(\lambda)\)</span>. We
can directly call the boot.ci function in R to calculate the interval
corresponding to these four methods. To make the sample well
representative of the population, we set the number of resamples to
R=10000.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>data <span class="ot">=</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>lambda.inverse <span class="ot">=</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>bootobject <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> data,<span class="at">statistic =</span> lambda.inverse,<span class="at">R=</span><span class="dv">10000</span>)</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>CI <span class="ot">=</span> <span class="fu">boot.ci</span>(bootobject, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>), <span class="at">conf=</span><span class="fl">0.95</span>)</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">&quot;Method&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Normal&quot;</span>, <span class="st">&quot;Basic&quot;</span>, <span class="st">&quot;Percentile&quot;</span>, <span class="st">&quot;BCa&quot;</span>),<span class="st">&quot;CI_l&quot;</span><span class="ot">=</span><span class="fu">c</span>(CI<span class="sc">$</span>norm[<span class="dv">2</span>],CI<span class="sc">$</span>basic[<span class="dv">4</span>],CI<span class="sc">$</span>percent[<span class="dv">4</span>],CI<span class="sc">$</span>bca[<span class="dv">4</span>]),<span class="st">&quot;CI_r&quot;</span><span class="ot">=</span><span class="fu">c</span>(CI<span class="sc">$</span>norm[<span class="dv">3</span>],CI<span class="sc">$</span>basic[<span class="dv">5</span>],CI<span class="sc">$</span>percent[<span class="dv">5</span>],CI<span class="sc">$</span>bca[<span class="dv">5</span>]))</span></code></pre></div>
<pre><code>##       Method     CI_l     CI_r
## 1     Normal 35.05313 182.4408
## 2      Basic 25.75417 170.0833
## 3 Percentile 46.08333 190.4125
## 4        BCa 56.16667 221.4406</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">hist</span>(bootobject<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>) </span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="fu">points</span>(bootobject<span class="sc">$</span>t0, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>If we want to apply the confidence interval of the normal
distribution, we have to assume that the distribution of <span class="math inline">\(1/\hat\lambda\)</span> is normal, or that there is
a central limit theorem with a large enough sample size. From the above
situation, we can see why the normal and percentile intervals are
different. From the histogram, the distribution is skewed. Since the
data is not approximately normal, the confidence interval obtained by
Bootstrap percentile method with bias correction (BCa) will be more
accurate.</p>
</div>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<p>First let’s review the content of Exercise 7.7: Efron and Tibshirani
(1993) discuss the following example. The five-dimensional scores data
have a <span class="math inline">\(5 \times 5\)</span> covariance matrix
<span class="math inline">\(\Sigma\)</span>, with positive eigenvalues
<span class="math inline">\(\hat{\lambda}_1&gt;\dots&gt;\hat{\lambda}_5\)</span>
be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,
where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of
<span class="math inline">\(\Sigma\)</span>. Compute the sample estimate
<span class="math inline">\(\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^5\hat{\lambda}_j}\)</span>
of <span class="math inline">\(\theta=\frac{\lambda_1}{\sum_{j=1}^5\lambda_j}\)</span>.</p>
<p>Since the Jackknife method is equivalent to leave-one-out method, the
idea is as follows: Suppose that there are n groups of samples <span class="math inline">\(X_i, 1\le i \le n\)</span>, one group of samples
is used as the test set, and another n-1 groups of samples are used as
the training set with n times, each time changing into different
training sets and test sets.</p>
<p>An unbiased estimate of the bias <span class="math inline">\(E(\theta)−\theta_0\)</span> is <span class="math inline">\((n-1)(\bar{\hat{\theta}}_{(\cdot)}-\hat{\theta})\)</span>.
An unbiased estimate of <span class="math inline">\(Var(\hat{\theta})\)</span> is <span class="math inline">\(\frac{n-1}{n}\sum_{i=1}^{n}(\bar{\hat{\theta}}_{(\cdot)}-\hat{\theta}_{(i)})^2\)</span>.</p>
<p>The code is as follows:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a> data<span class="ot">=</span>scor</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a> n<span class="ot">=</span><span class="fu">nrow</span>(data)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a> theta_jack <span class="ot">=</span> <span class="fu">numeric</span>(n)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a> lambda <span class="ot">=</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(data))<span class="sc">$</span>values</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a> theta_hat <span class="ot">=</span> <span class="fu">max</span>(lambda)<span class="sc">/</span><span class="fu">sum</span>(lambda)  <span class="co">#\hat{\theta}</span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a> Y <span class="ot">=</span> data[<span class="sc">-</span>i, ]</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a> lambda <span class="ot">=</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(Y))<span class="sc">$</span>values</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a> theta_jack[i] <span class="ot">=</span> <span class="fu">max</span>(lambda)<span class="sc">/</span><span class="fu">sum</span>(lambda)  <span class="co">#\hat{\theta}_{(i)}</span></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a> }</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a> bias_jack <span class="ot">=</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jack) <span class="sc">-</span> theta_hat)</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a> se_jack <span class="ot">=</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta_jack<span class="sc">-</span>theta_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a> <span class="fu">c</span>(theta_hat, bias_jack, se_jack)</span></code></pre></div>
<pre><code>## [1] 0.619115038 0.001069139 0.049552440</code></pre>
<p>The jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span> are 0.0010691 and
0.0495524.</p>
</div>
</div>
<div id="question-7.11" class="section level2">
<h2>Question 7.11</h2>
<p>Leave-one-out (n-fold) cross validation was used to select the best
fitting model for the ironslag data. Use leave-two-out cross validation
to compare the models.</p>
<div id="answer-16" class="section level3">
<h3>Answer</h3>
<p>The ironslag data for this problem is available in the DAAG package,
containing 53 measurements of iron content by two methods, chemical and
magnetic. The purpose is to find a relationship between chemical and
magnetic. Let us assume magnetic as the dependent variable <span class="math inline">\(Y\)</span> and chemical as the independent
variable <span class="math inline">\(X\)</span>, and consider four
possible regression analyses:</p>
<ol style="list-style-type: decimal">
<li><p>Linear: <span class="math inline">\(Y = \beta_0 + \beta_1X +
\epsilon\)</span></p></li>
<li><p>Quadratic: <span class="math inline">\(Y =\beta_0+ \beta_1X +
\beta_2X^2 + \epsilon\)</span></p></li>
<li><p>Exponential: <span class="math inline">\(\log(Y) = \beta_0 +
\beta_1 X + \epsilon\)</span></p></li>
<li><p>Log-log: <span class="math inline">\(\log(Y) = \beta_0+
\beta_1\log(X) + \epsilon\)</span></p></li>
</ol>
<p>Since the samples are pairs of samples <span class="math inline">\((X_i,Y_i)\)</span>, when deleting samples, we must
delete them in pairs. In addition, the meaning of leave-two-out cross
validation is: Suppose that there are n groups of samples <span class="math inline">\(\{(X_i,Y_i), 1\le i \le n\}\)</span>, two groups
of samples are used as the test set, and another n-2 groups of samples
are used as the training set with <span class="math inline">\(\binom{n}{2}\)</span> times, each time changing
into different training sets and test sets.</p>
<p>The code is as follows:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a> <span class="fu">library</span>(DAAG)</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a> data<span class="ot">=</span>ironslag</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a> n <span class="ot">=</span> <span class="fu">NROW</span>(data)</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a> N <span class="ot">=</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a> chemical<span class="ot">=</span>data[,<span class="dv">1</span>]</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a> magnetic<span class="ot">=</span>data[,<span class="dv">2</span>]</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a> e<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>))</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>   <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>  {</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  x <span class="ot">=</span> chemical[<span class="fu">c</span>(<span class="sc">-</span>i,<span class="sc">-</span>j)]</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>  y <span class="ot">=</span> magnetic[<span class="fu">c</span>(<span class="sc">-</span>i,<span class="sc">-</span>j)]</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a> <span class="do">## Linear: Y = β0 + β1X + epsilon</span></span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a> model1 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a> magnetic_hat1 <span class="ot">=</span> model1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> model1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a> e[<span class="dv">1</span>] <span class="ot">=</span> e[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">sum</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> magnetic_hat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a> <span class="do">## Quadratic: Y = β0 + β1X + β2X^2 + epsilon</span></span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a></span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a> model2 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a> magnetic_hat2 <span class="ot">=</span> model2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> model2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)] <span class="sc">+</span>model2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a> e[<span class="dv">2</span>] <span class="ot">=</span> e[<span class="dv">2</span>]<span class="sc">+</span><span class="fu">sum</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> magnetic_hat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a> <span class="do">## Exponential: log(Y) = β0 + β1X +  epsilon</span></span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a></span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a> model3 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a> magnetic_hat3 <span class="ot">=</span> <span class="fu">exp</span>(model3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> model3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)])</span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a> e[<span class="dv">3</span>] <span class="ot">=</span> e[<span class="dv">3</span>]<span class="sc">+</span><span class="fu">sum</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> magnetic_hat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a> <span class="do">## Log-log: log(Y) = β0 + β1log(X) + epsilon</span></span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a> </span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a> model4 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a> magnetic_hat4 <span class="ot">=</span> <span class="fu">exp</span>(model4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> model4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[<span class="fu">c</span>(i,j)]))</span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a> e[<span class="dv">4</span>] <span class="ot">=</span> e[<span class="dv">4</span>]<span class="sc">+</span><span class="fu">sum</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> magnetic_hat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a>}</span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a>e<span class="ot">=</span>e<span class="sc">/</span>N</span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a>e</span></code></pre></div>
<pre><code>##          [,1]     [,2]     [,3]     [,4]
## [1,] 39.14455 35.74037 36.90983 40.93436</code></pre>
<p>It can be seen from the results that after leave-two-out cross
validation, the average residual error of the four methods is
39.1445451, 35.7403651, 36.9098271 and 40.9343573 respectively. It can
be seen that the quadratic model has the smallest residual.</p>
</div>
</div>
</div>
<div id="homework7-2023.10.30" class="section level1">
<h1>Homework7 2023.10.30</h1>
<div id="question-on-the-blackborad" class="section level2">
<h2>Question on the blackborad</h2>
<p>Proof the stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<div id="answer-17" class="section level3">
<h3>Answer</h3>
<p>The procedure of the Metropolis-Hastings sampler Algorithm is as
follows:</p>
<ol style="list-style-type: decimal">
<li>Target pdf: <span class="math inline">\(f(x)\)</span>.</li>
<li>Replace i and j with s and r.</li>
<li>Proposal distribution (pdf): <span class="math inline">\(g(r\mid
s)\)</span>.</li>
<li>Acceptance probability: <span class="math inline">\(\alpha(s,r)=\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}\)</span>.</li>
<li>Transition kernel (mixture distribution): <span class="math display">\[
K(r,s) = \alpha(r,s)g(s|r) + I(s = r)[1 −\int \alpha(r,s)g(s|r)].
\]</span></li>
<li>Stationarity: <span class="math inline">\(K(s,r)f(s) =
K(r,s)f(r)\)</span>.</li>
</ol>
<p>We can talk about it in two ways, when <span class="math inline">\(f(r)g(s|r)&gt;f(s)g(r|s)\)</span>, we can get
<span class="math inline">\(\alpha(s,r)=1\)</span>, <span class="math inline">\(\alpha(r,s)=\frac{f(s)g(r|s)}{f(r)g(s|r)}\)</span>,
thus <span class="math display">\[
\begin{aligned}
K(r,s)f(r)&amp;=\frac{f(s)g(r|s)}{f(r)g(s|r)}f(r)g(s|r) + I(s = r)[1
−\int\frac{f(s)g(r|s)}{f(r)g(s|r)}g(s|r)]f(r)\\
&amp;=f(s)g(r|s) + I(s = r)[f(r) −\int f(s)g(r|s)],
\end{aligned}
\]</span> and <span class="math display">\[
\begin{aligned}
K(s,r)f(s)&amp;=g(r|s)f(s) + I(r = s)[1 −\int g(r|s)]f(s)\\
&amp;=g(r|s)f(s) + I(r = s)[f(s) −\int g(r|s)f(s)],
\end{aligned}
\]</span> so <span class="math inline">\(K(s,r)f(s) =
K(r,s)f(r)\)</span>. When <span class="math inline">\(f(r)g(s|r)&lt;f(s)g(r|s)\)</span>, we can get
<span class="math inline">\(\alpha(r,s)=1\)</span>, <span class="math inline">\(\alpha(s,r)=\frac{f(s)g(r|s)}{f(r)g(s|r)}\)</span>,
thus <span class="math display">\[
\begin{aligned}
K(s,r)f(s)&amp;=\frac{f(r)g(s|r)}{f(s)g(r|s)}f(s)g(r|s) + I(s = r)[1
−\int\frac{f(r)g(s|r)}{f(s)g(r|s)}g(r|s)]f(s)\\
&amp;=g(s|r)f(r) + I(r = s)[f(r) −\int g(s|r)f(r)],
\end{aligned}
\]</span> and <span class="math display">\[
\begin{aligned}
K(r,s)f(r)&amp;=g(s|r)f(r) + I(r = s)[1 −\int g(s|r)]f(r)\\
&amp;=g(s|r)f(r) + I(r = s)[f(r) −\int g(s|r)f(r)],
\end{aligned}
\]</span> so <span class="math inline">\(K(s,r)f(s) =
K(r,s)f(r)\)</span>.</p>
</div>
</div>
<div id="question-8.1" class="section level2">
<h2>Question 8.1</h2>
<p>Implement the two-sample Cram<span class="math inline">\(\acute{e}\)</span>r-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div id="answer-18" class="section level3">
<h3>Answer</h3>
<p>The Cramer-von Mises test is a nonparametric test used to test
whether a column of data has the same distribution as another set of
data. The test statistic is defined as follows: <span class="math display">\[
W=\frac{mn}{(m+n)^2}[\sum_{i=1}^{n}(F_n(x_i)-G_m(x_i))^2+\sum_{j=1}^{m}(F_n(y_j)-G_m(y_j))^2],
\]</span> where <span class="math inline">\(F_n\)</span> is the ECDF of
the sample <span class="math inline">\(x_1,\dots,x_n\)</span> and <span class="math inline">\(G_m\)</span> is the ECDF of the sample <span class="math inline">\(y_1,\dots,y_m\)</span>.</p>
<p>First, we select three data in chickwts data set horsebean, linseed
and soybean, and then test whether their pairwise distribution is the
same.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>x1<span class="ot">=</span>chickwts[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span>]  <span class="co">#feed=horsebean</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>x2<span class="ot">=</span>chickwts[<span class="dv">11</span><span class="sc">:</span><span class="dv">22</span>,<span class="dv">1</span>]  <span class="co">#feed=linseed</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>x3<span class="ot">=</span>chickwts[<span class="dv">23</span><span class="sc">:</span><span class="dv">36</span>,<span class="dv">1</span>]  <span class="co">#feed=soybean</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>teststat<span class="ot">=</span><span class="cf">function</span>(x,y){</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">length</span>(y)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>R <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>stat0<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>stat <span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a> test<span class="ot">=</span><span class="cf">function</span>(x,y)</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>{</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a> s1<span class="ot">=</span><span class="dv">0</span>; s2<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a> s1<span class="ot">=</span>s1<span class="sc">+</span>(<span class="fu">sum</span>(<span class="fu">as.integer</span>(x<span class="sc">&lt;=</span>x[i]))<span class="sc">/</span>n<span class="sc">-</span><span class="fu">sum</span>(<span class="fu">as.integer</span>(y<span class="sc">&lt;=</span>x[i]))<span class="sc">/</span>m)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a> }</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a> s2<span class="ot">=</span>s2<span class="sc">+</span>(<span class="fu">sum</span>(<span class="fu">as.integer</span>(x<span class="sc">&lt;=</span>y[j]))<span class="sc">/</span>n<span class="sc">-</span><span class="fu">sum</span>(<span class="fu">as.integer</span>(y<span class="sc">&lt;=</span>y[j]))<span class="sc">/</span>m)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>  }</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a> <span class="fu">return</span> ((n<span class="sc">*</span>m)<span class="sc">/</span>(n<span class="sc">+</span>m)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(s1<span class="sc">+</span>s2))</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>}</span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a> stat0 <span class="ot">=</span><span class="fu">test</span>(x,y) </span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a></span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a> <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a> kk <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">+</span>m))</span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a> zr <span class="ot">=</span> z[kk]</span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a> xr <span class="ot">=</span> zr[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a> yr <span class="ot">=</span> zr[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">+</span>m)]</span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a> stat[k] <span class="ot">=</span><span class="fu">test</span>(xr,yr)</span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>}</span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a> stat1 <span class="ot">=</span> <span class="fu">c</span>(stat, stat0)</span>
<span id="cb55-33"><a href="#cb55-33" tabindex="-1"></a> statistic <span class="ot">=</span> stat0</span>
<span id="cb55-34"><a href="#cb55-34" tabindex="-1"></a> p_value <span class="ot">=</span> <span class="fu">mean</span>(stat1 <span class="sc">&gt;=</span> stat0)</span>
<span id="cb55-35"><a href="#cb55-35" tabindex="-1"></a> <span class="fu">return</span> (<span class="at">list=</span><span class="fu">c</span>(statistic,p_value))</span>
<span id="cb55-36"><a href="#cb55-36" tabindex="-1"></a>}</span>
<span id="cb55-37"><a href="#cb55-37" tabindex="-1"></a>ans1<span class="ot">=</span><span class="fu">teststat</span>(x1,x2)</span>
<span id="cb55-38"><a href="#cb55-38" tabindex="-1"></a>ans2<span class="ot">=</span><span class="fu">teststat</span>(x1,x3)</span>
<span id="cb55-39"><a href="#cb55-39" tabindex="-1"></a>ans3<span class="ot">=</span><span class="fu">teststat</span>(x2,x3)</span>
<span id="cb55-40"><a href="#cb55-40" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">&quot;Objects&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;horsebean-linseed&quot;</span>,<span class="st">&quot;horsebean-soybean&quot;</span>,<span class="st">&quot;linseed-soybean&quot;</span>),<span class="st">&quot;statistic&quot;</span><span class="ot">=</span><span class="fu">c</span>(ans1[<span class="dv">1</span>],ans2[<span class="dv">1</span>],ans3[<span class="dv">1</span>]),<span class="st">&quot;p_value&quot;</span><span class="ot">=</span><span class="fu">c</span>(ans1[<span class="dv">2</span>],ans2[<span class="dv">2</span>],ans3[<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>##             Objects statistic     p_value
## 1 horsebean-linseed 0.7212121 0.009950249
## 2 horsebean-soybean 1.2233631 0.004975124
## 3   linseed-soybean 0.1515216 0.402985075</code></pre>
<p>It can be seen from the results that only the p value of linseed and
soybean is greater than 0.05, which can be considered as the same
distribution.</p>
</div>
</div>
<div id="question-8.3" class="section level2">
<h2>Question 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<div id="answer-19" class="section level3">
<h3>Answer</h3>
<p>The two-sample “Count Five” variance equality test counts the number
of extreme points for each sample relative to the other sample. Assuming
that the two samples have equal means and equal sample sizes,
observations in one sample are considered extreme if they are not within
the range of the other. If any sample has five or more extreme points,
the hypothesis of equal variance is rejected.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a> outliers <span class="ot">=</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a> X <span class="ot">=</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a> Y <span class="ot">=</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a> outlierx <span class="ot">=</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a> outliery <span class="ot">=</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outlierx, outliery))) }</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a> test <span class="ot">=</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">300</span>) {</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a> z <span class="ot">=</span> <span class="fu">c</span>(x, y)</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a> nx <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a> ny <span class="ot">=</span> <span class="fu">length</span>(y)</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a> stats<span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R)</span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a> {</span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a> k <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(nx<span class="sc">+</span>ny))</span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a> kx <span class="ot">=</span> k[<span class="dv">1</span><span class="sc">:</span>nx]</span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a> ky <span class="ot">=</span> k[(nx <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(nx<span class="sc">+</span>ny)]</span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a> stats[i]<span class="ot">=</span><span class="fu">outliers</span>(z[kx], z[ky]) </span>
<span id="cb57-19"><a href="#cb57-19" tabindex="-1"></a> }</span>
<span id="cb57-20"><a href="#cb57-20" tabindex="-1"></a> stat0 <span class="ot">=</span> <span class="fu">outliers</span>(x, y)</span>
<span id="cb57-21"><a href="#cb57-21" tabindex="-1"></a> statp <span class="ot">=</span> <span class="fu">c</span>(stats, stat0)</span>
<span id="cb57-22"><a href="#cb57-22" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estimate =</span> stat0, <span class="at">p =</span> <span class="fu">mean</span>(statp <span class="sc">&gt;=</span> stat0)))</span>
<span id="cb57-23"><a href="#cb57-23" tabindex="-1"></a> }</span>
<span id="cb57-24"><a href="#cb57-24" tabindex="-1"></a> </span>
<span id="cb57-25"><a href="#cb57-25" tabindex="-1"></a> </span>
<span id="cb57-26"><a href="#cb57-26" tabindex="-1"></a> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb57-27"><a href="#cb57-27" tabindex="-1"></a> x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb57-28"><a href="#cb57-28" tabindex="-1"></a> y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb57-29"><a href="#cb57-29" tabindex="-1"></a> <span class="fu">test</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 3
## 
## $p
## [1] 0.7375415</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a> x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a> y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a> <span class="fu">test</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 30
## 
## $p
## [1] 0.003322259</code></pre>
<p>We simulated and generated two samples X and Y with different sample
sizes. From the results, it can be seen that when the variance of X and
Y is equal, the p-value of the corresponding statistic is greater than
0.05; when the variance of X and Y is not equal, the p-value of the
corresponding statistic is less than 0.05, indicating that this test
method is feasible.</p>
</div>
</div>
</div>
<div id="homework8-2023.11.6" class="section level1">
<h1>Homework8 2023.11.6</h1>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="fl">1e6</span>; b1 <span class="ot">=</span> <span class="dv">0</span>; b2 <span class="ot">=</span> <span class="dv">1</span>; b3<span class="ot">=</span><span class="sc">-</span><span class="dv">1</span>; </span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rpois</span>(N, <span class="dv">1</span> ) </span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rexp</span>(N, <span class="dv">1</span>)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>x3<span class="ot">=</span><span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="cf">function</span>(a){<span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(a<span class="sc">+</span>b1<span class="sc">*</span>x1<span class="sc">+</span>b2<span class="sc">*</span>x2<span class="sc">+</span>b3<span class="sc">*</span>x3))) <span class="sc">-</span> <span class="fl">0.1</span>}</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="cf">function</span>(a){<span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(a<span class="sc">+</span>b1<span class="sc">*</span>x1<span class="sc">+</span>b2<span class="sc">*</span>x2<span class="sc">+</span>b3<span class="sc">*</span>x3))) <span class="sc">-</span> <span class="fl">0.01</span>}</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>g3 <span class="ot">=</span> <span class="cf">function</span>(a){<span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(a<span class="sc">+</span>b1<span class="sc">*</span>x1<span class="sc">+</span>b2<span class="sc">*</span>x2<span class="sc">+</span>b3<span class="sc">*</span>x3))) <span class="sc">-</span> <span class="fl">0.001</span>}</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a>g4 <span class="ot">=</span> <span class="cf">function</span>(a){<span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(a<span class="sc">+</span>b1<span class="sc">*</span>x1<span class="sc">+</span>b2<span class="sc">*</span>x2<span class="sc">+</span>b3<span class="sc">*</span>x3))) <span class="sc">-</span> <span class="fl">0.0001</span>}</span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>solution1 <span class="ot">=</span> <span class="fu">uniroot</span>(g1,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a>solution2 <span class="ot">=</span> <span class="fu">uniroot</span>(g2,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb61-12"><a href="#cb61-12" tabindex="-1"></a>solution3 <span class="ot">=</span> <span class="fu">uniroot</span>(g3,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb61-13"><a href="#cb61-13" tabindex="-1"></a>solution4 <span class="ot">=</span> <span class="fu">uniroot</span>(g4,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb61-14"><a href="#cb61-14" tabindex="-1"></a><span class="fu">c</span>(solution1<span class="sc">$</span>root,solution2<span class="sc">$</span>root,solution3<span class="sc">$</span>root,solution4<span class="sc">$</span>root)</span></code></pre></div>
<pre><code>## [1] 2.060912 4.515830 6.833016 9.137090</code></pre>
</div>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<div id="answer-20" class="section level3">
<h3>Answer</h3>
<p>The main formulas of the Metropolis-Hastings sampler Algorithm is as
follows:</p>
<ol style="list-style-type: decimal">
<li>Target pdf: standard Laplace distribution <span class="math inline">\(f(x)=\frac{1}{2}e^{−|x|}, x \in R\)</span>.</li>
<li>Proposal distribution pdf: Normal distribution <span class="math inline">\(g(r\mid
s)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}\)</span>.</li>
<li>Acceptance probability: <span class="math inline">\(\alpha(s,r)=\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}\)</span>.
Due to <span class="math inline">\(g(r|s)=g(s|r)\)</span>, so that <span class="math inline">\(\alpha(r,s) = \min\{f(s)/f(r),1\}\)</span>.</li>
</ol>
<p>The procedure of the Metropolis-Hastings sampler Algorithm is as
follows:</p>
<ol style="list-style-type: decimal">
<li><p>Set <span class="math inline">\(g(·|X)\)</span> (proposal pdf) to
be the density of normal distribution.</p></li>
<li><p>Generate <span class="math inline">\(X_1\)</span> from <span class="math inline">\(g(·|X)\)</span>.</p></li>
<li><p>Repeat for <span class="math inline">\(i=2,\dots,N\)</span>:</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(g(·|X)\)</span>.</p></li>
<li><p>Generate <span class="math inline">\(U\)</span> from
Uniform(0,1).</p></li>
<li><p>Compute <span class="math inline">\(\alpha(X_{i−1},Y)=e^{|x_{i-1}|-|y|}\)</span>. If
<span class="math inline">\(U ≤ \min\{\alpha(X_{i−1},Y)\}\)</span>, then
accept Y and set <span class="math inline">\(X_i=Y}\)</span>; otherwise
set <span class="math inline">\(X_{i}=X_{i−1}\)</span>.</p></li>
<li><p>Set i=i+1.</p></li>
</ol>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a> rwjf <span class="ot">=</span> <span class="cf">function</span>(N, x0, sigma) {</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a> x<span class="ot">=</span><span class="fu">numeric</span>(N)</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a> x[<span class="dv">1</span>]<span class="ot">=</span>x0</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a> u<span class="ot">=</span><span class="fu">runif</span>(N)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a> k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) { </span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a> y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a> <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y))) {x[i]<span class="ot">=</span>y}</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a> <span class="cf">else</span> { x[i] <span class="ot">=</span> x[i<span class="dv">-1</span>];  k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span>; }</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a> }</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a> }</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a> N<span class="ot">=</span><span class="dv">5000</span></span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a> rw1<span class="ot">=</span><span class="fu">rwjf</span>(N, <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="fl">0.2</span>)</span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a> rw2<span class="ot">=</span><span class="fu">rwjf</span>(N, <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="fl">0.5</span>)</span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a> rw3<span class="ot">=</span><span class="fu">rwjf</span>(N, <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>, <span class="fl">1.7</span>), <span class="fl">1.7</span>)</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a> rw4<span class="ot">=</span><span class="fu">rwjf</span>(N, <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">3</span>), <span class="dv">3</span>)</span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a> <span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k)</span></code></pre></div>
<pre><code>## [1]  370  813 2180 3008</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a> burn<span class="ot">=</span><span class="dv">500</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a> y1<span class="ot">=</span>rw1<span class="sc">$</span>x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a> y2<span class="ot">=</span>rw2<span class="sc">$</span>x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a> y3<span class="ot">=</span>rw3<span class="sc">$</span>x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a> y4<span class="ot">=</span>rw4<span class="sc">$</span>x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a> <span class="fu">plot</span>(y1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a> <span class="fu">plot</span>(y2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a> <span class="fu">plot</span>(y3, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a> <span class="fu">plot</span>(y4, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v///8oQeZyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI20lEQVR4nO3dC3ubNhgFYLVLu3hbssWrV9f+/v/vHFehC3AkIRmZnPM8bQiIz+gNFzuRsRJmNWrvDag9BAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEkhlIPU32AspbrlwIBEIgkEJA568/5Nd3pb58ZCkXk71+klGP2/n83uDcTm8ZykXlGYBup9cG6Vs7eXn5ublcXNTCdIZyeRpKv9/c31/byWuzL5lVoq+e0QFAsQ9c6BBr9p5LnXtQHUC309cf3S50XTpLw3LJgk8B1Mj0B9K35HJHB9pcjkClHo9AESsSCKxIILAigcCKBAIrzgNFlT4KkJqZIpCam8wEpJyvMRuTIwTaWi4daHauOes4QCuNlFPkKEDhvw/6pEDh5bYDzVMsAqn5bwm0sEUEAltEoJVi5refGMh56vQ8QEr/r5abRgBZ6ysfSLnNlL00MFUAzXbC7Z7u2vBkAgK5zeoHGnE0gLm1nkoSkPKBdDtlVcnQo5SsA6kRye2LWGqfBMjZt22gviPj5tpA5kKje1uA9NRzA40z+2ZhQGpaugo0yJcGujQP0o3ruNh/m58r554dHSC1DWjsazSQ8ZBBiQK6fPmQ26n9s2ouoGk3WAOyzx4u0LjUBlI7APUjO+7vLz/LAakZoPG/obEHZP5bB1JlgcZhU+eXnxc4/MU5OJQGUhbQ0AnlAg0/bB9IRQOphwENY4PaYTB4D7KA1CyQmnaWECBlAakFoPGqtQeQPrBuJ7UOZBzsPpChY1jMAZkH4hKQWgGadl3jEUsCNVex/iC7v0cBqVQgw8LosN75TCC1CqQeBBRabhHIkHGBzB/0EpCaB9LznhtIKXtqBUhFAJmFnwtoOokCIMPJm68tZoD0EWesNJzxngPIvJ48FMjd0+wHrghIBQBNs+eXOED2F1979lCsF0hvcTqQTQGA5nfD+oB8kFxAqxxLy93jcAPQr+8L78GIBVruyXMCNU+NdRaeAsaUW9vzl4FwT2PXml+eAiRX1b3MyrQH5QeKAUDLk4Cafah998UDgLLmgUDNS/QvH+WAakoqUPNK9DUVyHn0gwI1+89vu+1BjzP1+x0MJPd39bxAoWf/LUDbYwDFXa7qB2qeCi2+C2wvoCi1hWcSGfeg9o9erxUBiaz31JlXHiiHkQPk/kILA9kXxOqAeqINLzYigOZedwMgrxEG8i8YW4Dad6S+9X8ZzAskOYEkDEhyA7UvWHuZa/oulASkl8oiULdEbCBZBDLOgeK02nIVW7whx5TQwQsm0Nj9vYAkE1BIggcvrAKJ27k5oL7UkwGFD14Yt18DyQyQO6NXGVsbQLIC5J+aZT+g5cELAUCmh8QDiWAgmbo/VTSB9Kyie5AEDF4IBZKxYyLGTzsBSKoAihi8MA80KdhAYgGJD6RrT7uZBSQekJhA8iigxcEL3hEOgESmTk198IH0LhMKNPVqH6DQcmpEmVRENM74zVYgmU7I80BmcTWtH9XvBCB9KlopFwokPpBeOtQxe50BKLbfhYCMs4jeKgAkJpBeYPfaAxpniT6XTVtiAcnnBZIwIDkKkC4TAGQtcLoyfX8QICkJZDZzNhQlASioHAKSxwPpbXBnhvUoT2aBhEB+OSVmN/tZymmZE0gOACQekL1aXiB5AiD9dROQZAXyJlAOBLS0LXUCWTP2BZqddxggp9QENLc22BbZD8j9dYdTPx/QcJZNBgpbmNQwsVwZICEQAJLZtcG2BC9MaphYbvYSMnxDoLX6q0DWPLsUgbx5dqlwoLgN3dwwsVwYkG66tjkECtqcTw4U8QgHAVpruQ3ImVUHUMaPrjkkUM6PrjkiUNaPrjkm0NJH1ySUOyJQ1o+uSQVaqVekeVTdDB9dY7Y8HtDiR9cs/z4o4rEPAZS13FGBgv70nPDYmX9WUY+doeEUAoEQCIRAIKWAHpqnuIrtGQKBEAiEQCC7AT1NdgIKLlpTk6LrpxatqUnR9VOL1tSk6PqpRWtqUnT91KI1NSm6fmrRmpoUXT+1aE1Niq6fWrSmJkXXTy1aU5Oi6x8+BAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBJIf6LoyjHot93c13CdVV/AngnLuBlBurTIkO1A7fHFxCONK7u/NSpd2cJ+u4E+EbUF3v8ytVcbkBuqHfpzj77zc3y3+MowSbSv4E0G5nVqgrVV0cgPpfqat3vyEdQV/IqjE5eXvBmhrFZ3sQO07FdLvBntuOjJW8CcCN6A9B22sMiU3UH+Qp5yEurWbs7Su4E8EVGgPpBZoWxUjVQFdx3N0etfatwBUDbTlEOs/P2fTwdE1rfoQ23CSvpifL5R4er0Mg1veqj1JJ1/mjbt8br1An2u+zCc/Ufz1fRw7u/kp3rnmJ4rdXp5yih4OjnZVXcGfCEr/UmNrlSF8sQpCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgdQH5I0vSB2ulicEAiEQSJVAt9NfJ9WNp2pHrPwzDIlpB6C1A8S621o/LJUCtaPum3/tLdCvavimHWLVDhNbulVzmVQK9NqNVeyHFZ6HGd0AzOvXf/946BFXKdBbd//zfkiqHsLbeZ29ezWXTdVAFw00Dl5txwovfN5AoVQN5OxBbe7vf6a+zSEtVQMNQ5uHGV0uL/+t3Eq2QKoG6i5e+irWn63f0t8pk5S6geznQQ1MP0b8kafp+oAqC4FACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAvkfJDmFSY142mwAAAAASUVORK5CYII=" /><!-- --></p>
<p>According to the diagram above, a short aging sample of size 500 is
discarded from each chain. Each chain seems to converge to the target
Laplacian distribution. The chain 3 corresponding to <span class="math inline">\(\sigma = 1.7\)</span> has the best fit.</p>
</div>
</div>
<div id="question-9.7" class="section level2">
<h2>Question 9.7</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t ,Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = β_0 + β_1X\)</span> to the sample
and check the residuals of the model for normality and constant
variance.</p>
<div id="answer-21" class="section level3">
<h3>Answer</h3>
<p>The target distribution is bivariate normal: <span class="math inline">\((X_1,X_2) \sim
N(µ_1,µ_2,\sigma_1^2,\sigma_2^2,\rho)\)</span>.</p>
<p>Conditional distributions are <span class="math display">\[
(X_1 \mid X_2) \sim
N(\mu_1+\rho\sigma_1/\sigma_2(x_2-\mu_2),(1-\rho^2)\sigma_1^2)
\]</span></p>
<p><span class="math display">\[
(X_2 \mid X_1) \sim
N(\mu_2+\rho\sigma_2/\sigma_1(x_1-\mu_1),(1-\rho^2)\sigma_2^2)
\]</span></p>
<p>The procedure of the Gibbs Algorithm is as follows: 1) Set <span class="math inline">\(g(·|X)\)</span> (proposal pdf) to be the density
of normal distribution. 2) Generate <span class="math inline">\(X_1\)</span> from <span class="math inline">\(g(·|X)\)</span>. 3) Repeat for <span class="math inline">\(i=2,\dots,N\)</span>: (a) Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(g(·|X)\)</span>. (b) Generate <span class="math inline">\(U\)</span> from Uniform(0,1). (c) Compute <span class="math inline">\(\alpha(X_{i−1},Y)\)</span>. If <span class="math inline">\(U \le \min\{\alpha(X_{i−1},Y)\}\)</span>, then
accept Y and set <span class="math inline">\(X_{i}=Y\)</span>, otherwise
set <span class="math inline">\(X_{i}=X_{i−1}\)</span>. (d) Set
i=i+1.</p>
<p>For <span class="math inline">\(t=1,\dots,T\)</span>\ Step 1. Sets
<span class="math inline">\((x_1,x_2)=X(t−1)\)</span>\ Step 2. Generates
<span class="math inline">\(X_1^∗(t)\)</span> from <span class="math inline">\(f(\cdot|x_2)\)</span>\ Step 3. Updates <span class="math inline">\(x_1 = X_1^∗(t)\)</span>\ Step 4. Generates <span class="math inline">\(X_2^∗(t)\)</span> from <span class="math inline">\(f(\cdot|x_1)\)</span>\ Step 5. Sets <span class="math inline">\(X(t)=(X_1^∗(t),X_2^∗(t))\)</span>\ Step 6.
t=t+1</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">5000</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>burn<span class="ot">=</span><span class="dv">1000</span>  <span class="do">##discard a suitable burn-in sample</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>data<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>rho<span class="ot">=</span><span class="fl">0.9</span></span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>mux<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>muy<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>sigma_x<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>sigma_y<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>s1<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma_x</span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>s2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma_y</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>data[<span class="dv">1</span>,]<span class="ot">=</span><span class="fu">c</span>(mux,muy)</span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>yy<span class="ot">=</span>data[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>m1<span class="ot">=</span>mux<span class="sc">+</span>rho<span class="sc">*</span>sigma_x<span class="sc">/</span>sigma_y<span class="sc">*</span>(yy<span class="sc">-</span>muy)</span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>data[i,<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>xx<span class="ot">=</span>data[i,<span class="dv">1</span>]</span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>m2<span class="ot">=</span>muy<span class="sc">+</span>rho<span class="sc">*</span>sigma_y<span class="sc">/</span>sigma_x<span class="sc">*</span>(xx<span class="sc">-</span>mux)</span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>data[i,<span class="dv">2</span>]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>}</span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>X<span class="ot">=</span>data[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>]</span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a>Y<span class="ot">=</span>data[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>]</span>
<span id="cb69-22"><a href="#cb69-22" tabindex="-1"></a>model<span class="ot">=</span><span class="fu">lm</span>(Y<span class="sc">~</span>X)  <span class="do">##fit a simple linear regression model</span></span>
<span id="cb69-23"><a href="#cb69-23" tabindex="-1"></a>model</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Coefficients:
## (Intercept)            X  
##    -0.00732      0.89861</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- -->
The fitting coefficient of the linear model is in good agreement with
the covariance coefficient of the target model. If <span class="math inline">\(Y=0.9X\)</span> and <span class="math inline">\(Var(X)=Var(Y)=1\)</span>, then <span class="math inline">\(Cor(X,Y)=0.9\)</span>. In general, the residual of
the model can satisfy the normal distribution.</p>
</div>
</div>
<div id="question-9.10" class="section level2">
<h2>Question 9.10</h2>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span> &lt; 1.2. (See Exercise 9.9.)
Also use the coda[212] package to check for convergence of the chain by
the Gelman-Rubin method. Hints: See the help topics for the coda
functions gelman.diag, gelman.plot, as.mcmc, and mcmc.list.</p>
<div id="answer-22" class="section level3">
<h3>Answer</h3>
<p>The Rayleigh density [156, (18.76)] is <span class="math display">\[
f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2}),\quad x \ge 0,\sigma&gt;0.
\]</span></p>
<p>Gelman-Rubin statistic is <span class="math display">\[
\sqrt{\hat{R}}=\sqrt{var(\phi)/W_n}
\]</span> For the proposal distribution, try the chi-squared
distribution with degrees of freedom <span class="math inline">\(X_t\)</span>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a> Gelman_Rubin<span class="ot">=</span><span class="cf">function</span>(phi) {</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a> phi<span class="ot">=</span><span class="fu">as.matrix</span>(phi)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a> n<span class="ot">=</span><span class="fu">ncol</span>(phi)</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a> B<span class="ot">=</span>n <span class="sc">*</span> <span class="fu">var</span>(<span class="fu">rowMeans</span>(phi)) <span class="co">#between variance est.</span></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a> W<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">apply</span>(phi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>))  <span class="co">#within est.</span></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a> v_hat<span class="ot">=</span>W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a> r_hat<span class="ot">=</span>v_hat<span class="sc">/</span>W <span class="co">#G-R statistic</span></span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a> <span class="fu">return</span>(r_hat)</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a> }</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a> f <span class="ot">=</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a> <span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">0</span>)  {<span class="fu">return</span>(<span class="dv">0</span>)}</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a> <span class="fu">return</span>((x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>}</span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a> Rayleigh_MH <span class="ot">=</span> <span class="cf">function</span>(sigma, m, x0) {</span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a> x <span class="ot">=</span> <span class="fu">numeric</span>(m);  x[<span class="dv">1</span>] <span class="ot">=</span> x0;  u <span class="ot">=</span> <span class="fu">runif</span>(m);</span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a> xt <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a> y <span class="ot">=</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a> num <span class="ot">=</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a> den <span class="ot">=</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb72-22"><a href="#cb72-22" tabindex="-1"></a> alpha<span class="ot">=</span>num<span class="sc">/</span>den</span>
<span id="cb72-23"><a href="#cb72-23" tabindex="-1"></a> <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> alpha)</span>
<span id="cb72-24"><a href="#cb72-24" tabindex="-1"></a> x[i] <span class="ot">=</span> y</span>
<span id="cb72-25"><a href="#cb72-25" tabindex="-1"></a> <span class="cf">else</span> x[i] <span class="ot">=</span> xt</span>
<span id="cb72-26"><a href="#cb72-26" tabindex="-1"></a> }</span>
<span id="cb72-27"><a href="#cb72-27" tabindex="-1"></a> <span class="fu">return</span>(x)</span>
<span id="cb72-28"><a href="#cb72-28" tabindex="-1"></a> }</span>
<span id="cb72-29"><a href="#cb72-29" tabindex="-1"></a> sigma<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb72-30"><a href="#cb72-30" tabindex="-1"></a> x0 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span>sigma, sigma<span class="sc">^</span><span class="dv">2</span>, sigma<span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb72-31"><a href="#cb72-31" tabindex="-1"></a> k <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb72-32"><a href="#cb72-32" tabindex="-1"></a> m <span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb72-33"><a href="#cb72-33" tabindex="-1"></a> X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> m)</span>
<span id="cb72-34"><a href="#cb72-34" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) </span>
<span id="cb72-35"><a href="#cb72-35" tabindex="-1"></a>   X[i, ] <span class="ot">=</span> <span class="fu">Rayleigh_MH</span>(sigma, m, x0[i])</span>
<span id="cb72-36"><a href="#cb72-36" tabindex="-1"></a> phi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb72-37"><a href="#cb72-37" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) </span>
<span id="cb72-38"><a href="#cb72-38" tabindex="-1"></a>   phi[i, ] <span class="ot">=</span> phi[i, ]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb72-39"><a href="#cb72-39" tabindex="-1"></a> rhat<span class="ot">=</span><span class="fu">Gelman_Rubin</span>(phi)</span>
<span id="cb72-40"><a href="#cb72-40" tabindex="-1"></a> rhat</span></code></pre></div>
<pre><code>## [1] 1.175793</code></pre>
<p>Due to R=1.1757925&lt;1.1, so the chain convergence. Next, we use the
coda package to check for convergence of the chain by the Gelman-Rubin
method.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a> <span class="fu">library</span>(coda)</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a> X1<span class="ot">=</span><span class="fu">as.mcmc</span>(X[<span class="dv">1</span>, ])</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a> X2<span class="ot">=</span><span class="fu">as.mcmc</span>(X[<span class="dv">2</span>, ])</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a> X3<span class="ot">=</span><span class="fu">as.mcmc</span>(X[<span class="dv">3</span>, ])</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a> X4<span class="ot">=</span><span class="fu">as.mcmc</span>(X[<span class="dv">4</span>, ])</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a> Y<span class="ot">=</span><span class="fu">mcmc.list</span>(X1, X2, X3, X4)</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a> <span class="fu">gelman.plot</span>(Y, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can also be seen from the figure that the chain converges.</p>
</div>
</div>
</div>
<div id="homework9-2023.11.13" class="section level1">
<h1>Homework9 2023.11.13</h1>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>Dut to <span class="math inline">\(X_1,\dots,X_n \sim
Exp(\lambda)\)</span>, the joint density function of <span class="math inline">\(X=(X_1,\dots,X_n)^{\top}\)</span> is <span class="math inline">\(f(x)=\lambda^n e^{-\lambda
\sum_{i=1}^{n}x_i}\)</span>.</p>
<p>MLE: <span class="math display">\[
\ln f(x,\lambda)=\ln \Pi_{i=1}^n P(u_i \le x_i \le v_i)=\ln \Pi_{i=1}^n
(e^{-\lambda u_i}-e^{-\lambda v_i})=\sum_{i=1}^n\ln  (e^{-\lambda
u_i}-e^{-\lambda v_i})
\]</span> <span class="math display">\[
\frac{\ln f(x,\lambda)}{\partial \lambda}=\sum_{i=1}^n \frac{
-u_ie^{-\lambda u_i+\lambda v_i}+v_i}{e^{-\lambda u_i+\lambda v_i}-1}=0,
\]</span> then <span class="math inline">\(\sum_{i=1}^n
(v_i-u_ie^{\lambda(v_i-u_i)})=0\)</span>.</p>
<p>EM:</p>
<p>Introduce hidden variable <span class="math inline">\(Z=(Z_1,\dots,Z_n)^{\top}\)</span>, so <span class="math inline">\(l(\lambda)=f(z|\lambda)=\lambda^n e^{-\lambda
\sum_{i=1}^{n}z_i}\)</span>. Then <span class="math display">\[
\ln l(\lambda)=n \ln \lambda -\lambda \sum_{i=1}^{n}z_i.
\]</span> then, <span class="math inline">\(E(\ln l(\lambda)|\{ u_i,
v_i\})=n \ln \lambda -\lambda \sum_{i=1}^{n}E(z_i|\{ u_i,
v_i\})\)</span>, then <span class="math inline">\(\hat{\lambda}=E_{max}(\ln l(\lambda)|\{ u_i,
v_i\})=\frac{n}{\sum_{i=1}^{n}E(z_i|\{ u_i, v_i\})}\)</span>.</p>
<p>In <span class="math inline">\(\lambda_t=f(\lambda_{t-1})\)</span>,
it can be calculated that<span class="math inline">\(f(\cdot)\)</span>
has a non-zero derivative at the fixed point MLE estimator, then EM
algorithm converges linearly.</p>
<p>According to the N-R algorithm, when solving the problem of <span class="math inline">\(g(\lambda)=\sum_{i=1}^n
(v_i-u_ie^{\lambda(v_i-u_i)})=0\)</span>, <span class="math inline">\(\lambda_t\)</span> can be iterated until it
converges by <span class="math inline">\(\lambda_t=\lambda_{t-1}-\frac{g(\lambda_{t-1})}{g&#39;(\lambda_{t-1})}\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="do">##########   MLE</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="do">###Interval data</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a><span class="do">##Initialize</span></span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>eps<span class="ot">=</span><span class="fl">10e-5</span></span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>MLElambda<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>minus<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(minus)<span class="sc">&gt;</span>eps)</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>{</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>  MLElambda1<span class="ot">=</span>MLElambda<span class="sc">-</span>(<span class="fu">sum</span>(v<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(MLElambda)))<span class="sc">/</span><span class="fu">sum</span>(<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(MLElambda))</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>  minus<span class="ot">=</span>MLElambda1<span class="sc">-</span>MLElambda</span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>  MLElambda<span class="ot">=</span>MLElambda1</span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>}</span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>MLElambda </span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>Through calculation, we can see that <span class="math inline">\(\hat{\lambda}_{MLE}=\)</span> 0.0719735 obtained
by EM algorithm. Due to the recurrence formula <span class="math inline">\(\lambda_{t}=\frac{n\lambda_{t-1}}{n-\lambda_{t-1}\frac{\ln
f(x,\lambda_{t-1})}{\partial \lambda_{t-1}}}\)</span>, We can design the
following iterative algorithm:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="do">########## EM</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="do">##Interval data</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span> <span class="co">#sample size</span></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a><span class="do">##Initialize</span></span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>eps<span class="ot">=</span><span class="fl">10e-5</span></span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>EMlambda<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>minus<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(minus)<span class="sc">&gt;</span>eps)</span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a>{</span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a>  EMlambda1<span class="ot">=</span>n<span class="sc">*</span>EMlambda<span class="sc">/</span>(n<span class="sc">-</span>EMlambda<span class="sc">*</span><span class="fu">sum</span>((v<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(EMlambda))<span class="sc">/</span>(<span class="fu">exp</span>(EMlambda)<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a>  minus<span class="ot">=</span>EMlambda1<span class="sc">-</span>EMlambda</span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a>  EMlambda<span class="ot">=</span>EMlambda1</span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a>}</span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a>EMlambda</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>Through calculation, we can see that <span class="math inline">\(\hat{\lambda}_{EM}=\)</span> 0.0719735 obtained by
EM algorithm.</p>
</div>
<div id="question-11.8" class="section level2">
<h2>Question 11.8</h2>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute B = A + 2, find the solution of
game B, and verify that it is one of the extreme points (11.12)–(11.15)
of the original game A. Also find the value of game A and game B.</p>
<div id="answer-23" class="section level3">
<h3>Answer</h3>
<p>In Example 11.17 of the book, we have outlined how to solve the Morra
game, so we just need to do some deformation on top of that.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>solvejf<span class="ot">=</span><span class="cf">function</span>(A){</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>min.A<span class="ot">=</span><span class="fu">min</span>(A);A<span class="ot">=</span>A<span class="sc">-</span>min.A</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>max.A<span class="ot">=</span><span class="fu">max</span>(A);A<span class="ot">=</span>A<span class="sc">/</span><span class="fu">max</span>(A)</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">nrow</span>(A);n<span class="ot">=</span><span class="fu">ncol</span>(A)</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>it<span class="ot">=</span>n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,m),<span class="dv">1</span>)</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>A1<span class="ot">=</span><span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A),<span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>,n))</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>b1<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>A3<span class="ot">=</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,m),<span class="dv">0</span>)))</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>b3<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>sx<span class="ot">=</span><span class="fu">simplex</span>(<span class="at">a=</span>a,<span class="at">A1=</span>A1,<span class="at">b1=</span>b1,<span class="at">A3=</span>A3,<span class="at">b3=</span>b3,<span class="at">maxi=</span><span class="cn">TRUE</span>,<span class="at">n.iter=</span>it)</span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="dv">1</span>)</span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>A1<span class="ot">=</span><span class="fu">cbind</span>(A,<span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>,m)); A3<span class="ot">=</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,n),<span class="dv">0</span>)))</span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a>b1<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,m); b3<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a>sy<span class="ot">=</span><span class="fu">simplex</span>(<span class="at">a=</span>a,<span class="at">A1=</span>A1,<span class="at">b1=</span>b1,<span class="at">A3=</span>A3,<span class="at">b3=</span>b3,<span class="at">maxi=</span><span class="cn">FALSE</span>,<span class="at">n.iter=</span>it)</span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a>soln<span class="ot">=</span><span class="fu">list</span>(<span class="at">A=</span>A<span class="sc">*</span>max.A<span class="sc">+</span>min.A,<span class="at">x=</span>sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],<span class="at">y=</span>sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],<span class="at">v=</span>sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>]<span class="sc">*</span>max.A<span class="sc">+</span>min.A)</span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a>soln</span>
<span id="cb79-18"><a href="#cb79-18" tabindex="-1"></a>}</span>
<span id="cb79-19"><a href="#cb79-19" tabindex="-1"></a><span class="do">##pay off matrix</span></span>
<span id="cb79-20"><a href="#cb79-20" tabindex="-1"></a>A<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb79-21"><a href="#cb79-21" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb79-22"><a href="#cb79-22" tabindex="-1"></a><span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,</span>
<span id="cb79-23"><a href="#cb79-23" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb79-24"><a href="#cb79-24" tabindex="-1"></a><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,</span>
<span id="cb79-25"><a href="#cb79-25" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>),<span class="dv">9</span>,<span class="dv">9</span>)</span>
<span id="cb79-26"><a href="#cb79-26" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb79-27"><a href="#cb79-27" tabindex="-1"></a>B<span class="ot">=</span>A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb79-28"><a href="#cb79-28" tabindex="-1"></a>s<span class="ot">=</span><span class="fu">solvejf</span>(B)</span>
<span id="cb79-29"><a href="#cb79-29" tabindex="-1"></a> s<span class="sc">$</span>v  <span class="co"># the value of the game</span></span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a> <span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y), <span class="dv">4</span>) <span class="do">## optimal strategies for each player</span></span></code></pre></div>
<pre><code>##      [,1]   [,2]
## x1 0.0000 0.0000
## x2 0.0000 0.0000
## x3 0.4098 0.4098
## x4 0.0000 0.0000
## x5 0.3279 0.3279
## x6 0.0000 0.0000
## x7 0.2623 0.2623
## x8 0.0000 0.0000
## x9 0.0000 0.0000</code></pre>
<p>The optimal strategies returned by solvejf are the same for both
players.</p>
<p>It can be seen that the simplex algorithm terminates at the extreme
point given by formula (11.15).</p>
</div>
</div>
</div>
<div id="homework10-2023.11.20" class="section level1">
<h1>Homework10 2023.11.20</h1>
<div id="question-1-5" class="section level2">
<h2>Question 1</h2>
<div id="exercise-4" class="section level3">
<h3>2.1.3 Exercise 4</h3>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<p>Answer: When the as.vector’s object is an atomic vector, it removes
all its properties. If it is a list, it does not change. However, you
can turn a list into an atomic vector with unlist() . If the elements of
a list have different types, unlist() uses the same coercion rules as
c().</p>
</div>
<div id="exercise-1-2" class="section level3">
<h3>2.3.1 Exercise 1, 2</h3>
<ol style="list-style-type: decimal">
<li>What does dim() return when applied to a vector?</li>
<li>If is.matrix(x) is TRUE , what will is.array(x) return?</li>
</ol>
<p>Answer: 1. NULL. 2. TRUE.</p>
</div>
<div id="section" class="section level3">
<h3>2.4.5</h3>
<p>Exercise 2: What does as.matrix() do when applied to a data frame
with columns of different types? Exercise 3: Can you have a data frame
with 0 rows? What about 0 columns?</p>
<p>Answer: 2. After applying as.matrix() to a data frame, it is still a
matrix.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>new <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">col1 =</span> x,<span class="at">col2 =</span> y)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>mat <span class="ot">=</span> <span class="fu">as.matrix</span>(new) <span class="do">##apply as.matrix()</span></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a><span class="fu">is.matrix</span>(mat)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>The code is as follows:</li>
</ol>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span>)[<span class="dv">0</span>,,<span class="at">drop=</span><span class="cn">FALSE</span>])  <span class="co">#0 rows</span></span></code></pre></div>
<pre><code>## [1] 0 1</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span>)[,<span class="dv">0</span>,<span class="at">drop=</span><span class="cn">FALSE</span>])  <span class="co">#0 columns</span></span></code></pre></div>
<pre><code>## [1] 1 0</code></pre>
</div>
<div id="exercises-2" class="section level3">
<h3>Exercises 2</h3>
<p>The function below scales a vector so it falls in the range [0,1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>scale01 <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>rng <span class="ot">=</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>}</span></code></pre></div>
<p>Answer:</p>
<p>Function “lapply(X, FUN,…)” returns a list of the same length as X,
with the <span class="math inline">\(i^{th}\)</span> element being
FUN(X[[i]]). Next, we generate two data frames separately and use the
lapply function to apply the scale01 function to each column of the data
frame.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(data1, <span class="cf">function</span>(x) <span class="fu">scale01</span>(x)))</span></code></pre></div>
<pre><code>##    X1  X2  X3
## 1 0.0 0.0 0.0
## 2 0.5 0.5 0.5
## 3 1.0 1.0 1.0</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>data2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">b =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>), <span class="at">c =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(data2, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span></code></pre></div>
<pre><code>##     a     b c
## 1 0.0  TRUE a
## 2 0.5  TRUE b
## 3 1.0 FALSE c</code></pre>
<p>If the data type is not a number, we can add a judgment statement in
advance.</p>
</div>
<div id="exercises-1" class="section level3">
<h3>Exercises 1</h3>
<p>Use vapply() to: a) Compute the standard deviation of every column in
a numeric data frame. b) Compute the standard deviation of every numeric
column in a mixed data frame. (Hint: you’ll need to use vapply()
twice.)</p>
<p>Answer:</p>
<p>vapply(X,FUN,FUN.VALUE,…,USE.NAMES=TRUE) has a pre-specified type of
return value, so it can be safer (and sometimes faster) to use.</p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>sdjf <span class="ot">=</span> <span class="cf">function</span>(data){ </span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>  a <span class="ot">=</span> <span class="fu">vapply</span>(data,<span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sd</span>(x), <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(a))</span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>}</span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a><span class="fu">sdjf</span>(data1)</span></code></pre></div>
<pre><code>##    a
## X1 1
## X2 1
## X3 1</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>sdmixjf <span class="ot">=</span> <span class="cf">function</span>(data){ </span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>  data <span class="ot">=</span> data[<span class="fu">vapply</span>(data,<span class="at">FUN =</span> is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))]</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>  a <span class="ot">=</span> <span class="fu">vapply</span>(data,<span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sd</span>(x), <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(a))</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>}</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>data2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">b =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>), <span class="at">c =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a><span class="fu">sdmixjf</span>(data2)</span></code></pre></div>
<pre><code>##   a
## a 1</code></pre>
</div>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Consider Exercise 9.8 (pages 278, Statistical Computing with R).
(Hint: Refer to the first example of Case studies section) • Write an R
function. • Write an Rcpp function. • Compare the computation time of
the two functions with the function “microbenchmark”.</p>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y) \propto \binom{n}{x} y^{x+a-1}(1-y)^{ n−x+b−1},\quad x =
0,1,\dots,n, 0 \le y \le 1.
\]</span> It can be shown (see e.g. [23]) that for fixed a,b,n, the
conditional distributions are Binomial(n,y) and Beta(x+a,n−x+b). Use the
Gibbs sampler to generate a chain with target joint density f(x,y).</p>
<div id="answer-24" class="section level3">
<h3>Answer</h3>
<p>For a bivariate distribution <span class="math inline">\((X,Y)\)</span>, at each iteration the Gibbs
sampler. (1) Generate <span class="math inline">\(X^∗(t)\)</span> from
<span class="math inline">\(Binomial(n,Y(t−1))\)</span>. (2) Update
<span class="math inline">\(x(t)=X^∗(t)\)</span>; (3) Generate <span class="math inline">\(Y^∗(t)\)</span> from <span class="math inline">\(Beta(x(t)+a,n−x(t)+b)\)</span>. (4) Set <span class="math inline">\((X(t),(Y(t))=(X^∗(t),Y^∗(t))\)</span>..</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Rcpp&quot;</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a> <span class="fu">library</span>(microbenchmark)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>jfR <span class="ot">=</span> <span class="cf">function</span>(N,n,a,b){</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a> x<span class="ot">=</span>y<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a> x[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.2</span>, <span class="at">size =</span> n)</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a> y[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> x[<span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a> x[i] <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">prob =</span> y[i<span class="dv">-1</span>], <span class="at">size =</span> n)</span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a> y[i] <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i]<span class="sc">+</span>a, n<span class="sc">-</span>x[i]<span class="sc">+</span>b)</span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a> }</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a>}</span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="at">code=</span><span class="st">&#39; </span></span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a><span class="st">NumericMatrix jfC(int N, double n, double a, double b) {</span></span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a><span class="st">  NumericMatrix aa(N,2);</span></span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a><span class="st">  aa(0,0) = R::rbinom(n,0.2);</span></span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a><span class="st">  aa(0,1) = R::rbeta(aa(0,0)+a, n-aa(0,0)+b);</span></span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a><span class="st"> for(int i = 1; i &lt; N; i++) {</span></span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a><span class="st">   aa(i,0) = R::rbinom(n,aa(i-1,1));</span></span>
<span id="cb98-24"><a href="#cb98-24" tabindex="-1"></a><span class="st">   aa(i,1) = R::rbeta(aa(i,0)+a, n-aa(i,0)+b);</span></span>
<span id="cb98-25"><a href="#cb98-25" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb98-26"><a href="#cb98-26" tabindex="-1"></a><span class="st"> return(aa);</span></span>
<span id="cb98-27"><a href="#cb98-27" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb98-28"><a href="#cb98-28" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb98-29"><a href="#cb98-29" tabindex="-1"></a> N <span class="ot">=</span> <span class="dv">1000</span>;  a <span class="ot">=</span> <span class="dv">4</span>;  b<span class="ot">=</span><span class="dv">3</span>; n <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb98-30"><a href="#cb98-30" tabindex="-1"></a> <span class="do">## compare time</span></span>
<span id="cb98-31"><a href="#cb98-31" tabindex="-1"></a> t <span class="ot">=</span> <span class="fu">microbenchmark</span>(<span class="at">ar=</span><span class="fu">jfR</span>(N,n,a,b), <span class="at">aC=</span><span class="fu">jfC</span>(N,n,a,b))</span>
<span id="cb98-32"><a href="#cb98-32" tabindex="-1"></a> <span class="fu">summary</span>(t)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1   ar 3399.15 3524.15 3798.95
## 2   aC  224.80  228.45  240.25</code></pre>
<p>According to the question, Rcpp takes less time and is more
efficient.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
